(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(36605)}])},36605:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return eg}});var n=a(85893),s=a(11163),i=a.n(s),r=a(64078),l=a(82169),o=a(79911),c=a(64146),d=JSON.parse('[{"inputs":[{"internalType":"address","name":"_himitsuVerifierAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"continueSec","type":"uint256"}],"name":"createProposals","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getBlockTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"proposal","type":"uint256"}],"name":"getResult","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"himitsuVerifier","outputs":[{"internalType":"contract IHimitsuVerifier","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"proposals","outputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"address","name":"creater","type":"address"},{"internalType":"uint256","name":"acceptCount","type":"uint256"},{"internalType":"uint256","name":"denyCount","type":"uint256"},{"internalType":"uint256","name":"endTime","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"proof","type":"uint256"}],"name":"registerUser","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"totalProposals","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"users","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint256[2]","name":"a","type":"uint256[2]"},{"internalType":"uint256[2][2]","name":"b","type":"uint256[2][2]"},{"internalType":"uint256[2]","name":"c","type":"uint256[2]"}],"internalType":"struct BeePoll.ProofData","name":"proofData","type":"tuple"},{"internalType":"uint256[1]","name":"input","type":"uint256[1]"}],"name":"verifyProof","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"proposal","type":"uint256"},{"internalType":"bool","name":"accept","type":"bool"},{"components":[{"internalType":"uint256[2]","name":"a","type":"uint256[2]"},{"internalType":"uint256[2][2]","name":"b","type":"uint256[2][2]"},{"internalType":"uint256[2]","name":"c","type":"uint256[2]"}],"internalType":"struct BeePoll.ProofData","name":"proofData","type":"tuple"}],"name":"vote","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"voters","outputs":[{"internalType":"bool","name":"voted","type":"bool"}],"stateMutability":"view","type":"function"}]'),u=a(2593);let{buildPoseidon:p}=a(52647),{groth16:m}=a(92916);async function h(e){let{proof:t,publicSignals:a}=e,n=await m.exportSolidityCallData(t,a),s=n.replace(/["[\]\s]/g,"").split(",").map(u.O$.from),[i,r,l,o,c,d,p,h,...x]=s;return{a:[i,r],b:[[l,o],[c,d]],c:[p,h],inputs:x}}async function x(e,t,a){let{proof:n,publicSignals:s}=await m.fullProve(e,t,a),i=await h({proof:n,publicSignals:s});return i}let y=e=>BigInt("0x"+e).toString();async function f(e){let t=await p(),a=t.F.toString(t([y(e)])),n={value:"0x".concat(e),hash:a};console.log(n);let s=await x(n,"/himitsu.wasm","/himitsu.zkey");return console.log(s),s}let{buildPoseidon:b}=a(52647),w="0xCEFbaE8c6afEdC5C5e312B34fd8993EfD076d130",g=new l.r("https://ethereum-goerli.publicnode.com"),v=new o.Wallet("c0691182128fa46c6d8cc37864d9611f5a4823d81657ee927f25c9ad2ff978fa",g),j=new c.CH(w,d,v);async function N(e,t){j.registerUser(e,t)}async function k(e,t,a){let n=await f(e),s=await (0,r.$q)({address:w,abi:d,chainId:5,functionName:"vote",args:[t,a,n]});await (0,r.n9)(s)}async function C(e,t){let a=await (0,r.$q)({address:w,abi:d,chainId:5,functionName:"createProposals(string,uint256)",args:[e,t]});await (0,r.n9)(a)}async function T(e){let t=await (0,r.a4)({address:w,abi:d,chainId:5,functionName:"proposals(uint256)",args:[e]});return t}async function D(){let e=await (0,r.a4)({address:w,abi:d,chainId:5,functionName:"totalProposals()",args:[]});return e}async function S(){let e=[],t=await D();for(let a=0;a<t;a++){let t=await T(a);e.push(t)}return e}var _=a(67294),I=a(27484),E=a.n(I);function M(e){let[t,a]=(0,_.useState)(0),[s,i]=(0,_.useState)(0),[r,l]=(0,_.useState)(0),[o,c]=(0,_.useState)(0);return(0,_.useEffect)(()=>{let t=new Date(E().unix(e.endTime).format("MM/DD/YYYY HH:mm:ss")),n=setInterval(()=>{let e=new Date,n=t.getTime()-e.getTime();a(Math.floor(n/864e5)),i(Math.floor(n%864e5/36e5)),l(Math.floor(n%36e5/6e4)),c(Math.floor(n%6e4/1e3))},1e3);return()=>{clearInterval(n)}},[]),(0,n.jsxs)("span",{className:"countdown font-mono text-base ml-auto",children:[(0,n.jsx)("span",{style:{"--value":t}}),"d",(0,n.jsx)("span",{style:{"--value":s},className:"ml-1"}),"h",(0,n.jsx)("span",{style:{"--value":r},className:"ml-1"}),"m",(0,n.jsx)("span",{style:{"--value":o},className:"ml-1"}),"s"]})}function A(e){let t=(0,s.useRouter)();function a(t){if(!0===t){if("0x00"===e.denyCount._hex&&"0x00"===e.acceptCount._hex)return 0;if("0x00"===e.denyCount._hex)return 100;if("0x00"===e.acceptCount._hex)return 0;let t=100*i(e.acceptCount/(e.acceptCount+e.denyCount));return t}if("0x00"===e.denyCount._hex&&"0x00"===e.acceptCount._hex)return 0;if("0x00"===e.acceptCount._hex)return 100;if("0x00"===e.denyCount._hex)return 0;let a=100*i(e.denyCount/(e.acceptCount+e.denyCount));return a}function i(e){return Number(Number(e.toFixed(3)).toFixed(2))}return(0,n.jsx)("div",{className:" card dark:text-white dark:bg-slate-800 dark:border-white dark:border-solid dark:border-2 w-[350px] p-4 bg-white shadow-[0_3px_10px_rgb(0,0,0,0.2)] mt-3 cursor-pointer text-[#2E1503] ",onClick:function(){t.push({pathname:"/card",query:{proposalId:e.proposalId,proposalBody:e.proposalBody,acceptCount:e.acceptCount,denyCount:e.denyCount,creater:e.creater,endTime:e.endTime,credentialHash:e.credentialHash}})},children:(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsxs)("div",{className:"flex items-center mb-2",children:[(0,n.jsx)("h2",{className:"card-title",children:"VOTE # ".concat(e.proposalId+1)}),Date.now().valueOf()>new Date(E().unix(e.endTime).format("MM/DD/YYYY HH:mm:ss")).valueOf()?"end":(0,n.jsx)(M,{endTime:e.endTime.toString()})]}),(0,n.jsx)("p",{className:"text-left mb-4",children:e.proposalBody}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("p",{className:"text-xs text-left font-bold",children:"Yes"}),(0,n.jsx)("p",{className:"text-xs text-right font-bold",children:"".concat(a(!0),"%")})]}),(0,n.jsx)("progress",{className:"progress progress-success w-auto dark:bg-slate-950",value:a(!0),max:"100"}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("p",{className:"text-xs text-left font-bold",children:"No"}),(0,n.jsx)("p",{className:"text-xs text-right font-bold",children:"".concat(a(!1),"%")})]}),(0,n.jsx)("progress",{className:"progress progress-error w-auto dark:bg-slate-950 text-[#FF5E6C]",value:a(!1),max:"100"}),(0,n.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,n.jsx)("button",{className:"btn btn-outline btn-success w-20 border-2",onClick:function(t){k(e.credentialHash,e.proposalId,!0),t.stopPropagation()},children:"Accept"}),(0,n.jsx)("button",{className:"btn btn-outline btn-error w-20 border-2",onClick:function(t){k(e.credentialHash,e.proposalId,!1),t.stopPropagation()},children:"Deny"})]})]})})}function O(){return(0,n.jsx)("div",{className:"w-[170px] ml-4 mr-auto  mb-2 rounded-lg p-2 shadow-[0_3px_10px_rgb(0,0,0,0.2)]",children:(0,n.jsx)("div",{children:(0,n.jsxs)("select",{className:"bg-white text-black select select-bordered w-[150px] max-w-xs",children:[(0,n.jsx)("option",{disabled:!0,selected:!0,children:"Status"}),(0,n.jsx)("option",{children:"All"}),(0,n.jsx)("option",{children:"Open"}),(0,n.jsx)("option",{children:"Closed"})]})})})}var H=a(36919),V=a(38208),B=a(84582);function P(){let[e,t]=(0,_.useState)(!1),[a,s]=(0,_.useState)(0),[i,r]=(0,_.useState)(""),l=()=>{t(!0)},o=()=>{t(!1)},c=e=>{let t=new Date(e),a=t.getTime();s(a)},d=e=>{r(e.target.value)};return(0,n.jsxs)("div",{className:"ml-auto",children:[(0,n.jsx)("button",{className:"btn btn-outline h-1/3 btn-warning px-2",onClick:l,children:"New Vote"}),(0,n.jsx)(V.Z,{open:e,onClose:o,"aria-labelledby":"parent-modal-title","aria-describedby":"parent-modal-description",className:"z-10",children:(0,n.jsxs)(H.Z,{children:[(0,n.jsxs)("form",{method:"dialog",className:"modal-box fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:[(0,n.jsx)("h3",{className:"font-bold text-lg text-white",children:"Create your proposal"}),(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)(B.x,{label:"End Time",className:"z-50 text-white",onChange:c,sx:{width:"100%","& input":{color:"white"},".MuiOutlinedInput-root.MuiInputBase-formControl .MuiOutlinedInput-notchedOutline":{borderColor:"white"},".MuiInputLabel-root.MuiInputLabel-formControl":{color:"white"},".MuiSvgIcon-root":{fill:"white"}}}),(0,n.jsx)("input",{type:"text",placeholder:"Content",style:{color:"white",borderColor:"white"},className:"input input-bordered w-full my-4",onChange:d}),(0,n.jsx)("button",{className:"btn btn-outline btn-success mb-2 mt-4 btn-warning px-2",onClick:()=>{console.log("content",i),console.log("endTime",a),C(i,a)},children:"CREATE"})]})]}),(0,n.jsx)("form",{method:"dialog",className:"modal-backdrop",children:(0,n.jsx)("button",{children:"close"})})]})})]})}function F(e){let[t,a]=(0,_.useState)([]);return(0,_.useEffect)(()=>{S().then(e=>{a(e)})},[]),(0,n.jsxs)("div",{className:"mt-10",children:[(0,n.jsxs)("div",{className:"flex mt-10 w-1/2",children:[(0,n.jsx)("p",{className:"font-mono text-black font-bold text-3xl ml-5 mt-3 dark:text-white",children:"VOTING"}),(0,n.jsx)(P,{})]}),(0,n.jsx)("div",{className:"divider ml-5 mr-auto w-1/2 mt-0 mb-4"}),(0,n.jsx)(O,{}),(0,n.jsx)("div",{className:"mb-10 grid xl-[1320px] xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 justify-items-center",children:t.map((t,a)=>(0,n.jsx)(A,{proposalId:a,creater:t.creater,proposalBody:t.name,acceptCount:t.acceptCount,denyCount:t.denyCount,endTime:t.endTime,credentialHash:e.credentialHash},a))})]})}var J=a(47516),L=a(63750),z=a(69077),Z=a(42474),Y=a.n(Z);function W(e){if(!e)return"";if(e.length<=12)return e;{let t=e.slice(0,6),a=e.slice(-6);return"".concat(t,"...").concat(a)}}function U(e){let t={};for(let a in e)"@context"===a?t.context=e[a]:t[a]=e[a];return t}function G(){return Y().randomBytes(32).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var X=a(82010);function K(e){let{handleCopyClick:t,did:a}=e,[s,i]=(0,_.useState)(!1),[r,l]=(0,_.useState)(!1),{address:o,isConnected:c}=(0,z.mA)(),{theme:d}=(0,X.F)(),u=()=>{navigator.clipboard.writeText(o).then(()=>{i(!0),setTimeout(()=>{i(!1)},1e3)})},p=()=>{navigator.clipboard.writeText(a).then(()=>{l(!0),setTimeout(()=>{l(!1)},1e3)})};return(0,n.jsx)(n.Fragment,{children:c?(0,n.jsx)("div",{className:"ml-4",children:(0,n.jsxs)("div",{className:"realtive dark:border-white dark:border-solid dark:border-2 card w-[350px] p-2 light:bg-white shadow-[0_3px_10px_rgb(0,0,0,0.2)] mt-3 text-[#2E1503]",children:[(0,n.jsx)("div",{className:"card-body",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("img",{src:"https://github.com/EricLin0619/BeePoll/blob/gh-pages/ethereum.png?raw=true",className:"w-16"}),(0,n.jsx)("span",{className:"mt-2 font-bold font-mono dark:text-white",children:"Goerli"})]}),(0,n.jsxs)("div",{className:"ml-auto",children:[(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(J.xa5,{className:"text-black dark:text-white w-5 h-auto mr-1"}),(0,n.jsx)("span",{className:"font-mono font-bold dark:text-white",children:"Wallet Address"})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("p",{className:"font-mono dark:text-white",children:W(o)}),s?(0,n.jsx)(L.IQF,{className:"text-green-500 w-5 h-auto ml-1"}):(0,n.jsx)(J.LhG,{className:"text-black w-5 h-auto ml-1 cursor-pointer dark:text-white",onClick:()=>{t(),u()}})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(J.cf2,{className:"text-black dark:text-white w-5 h-auto mr-1"}),(0,n.jsx)("span",{className:"font-mono font-bold dark:text-white",children:"DID"})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("p",{className:"font-mono dark:text-white",children:a?W(a):"..."}),r?(0,n.jsx)(L.IQF,{className:"text-green-500 w-5 h-auto ml-1"}):(0,n.jsx)(J.LhG,{className:"text-black w-5 h-auto ml-1 cursor-pointer dark:text-white",onClick:()=>{t(),p()}})]})]})]})]})}),(0,n.jsx)("a",{href:"https://explorer.hypersign.id/hypersign-testnet/identity/"+a,target:"_blank",rel:"noreferrer",children:(0,n.jsx)("p",{className:"font-mono absolute bottom-0.5 right-2 text-black text-sm dark:text-white",children:"more..."})})]})}):(0,n.jsx)("div",{className:"ml-4",children:(0,n.jsx)("div",{className:" dark:border-white dark:border-solid dark:border-2 card w-[350px] p-2 light:bg-white shadow-[0_3px_10px_rgb(0,0,0,0.2)] mt-3 text-[#2E1503]",children:(0,n.jsx)("div",{className:"card-body",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex flex-col items-center",children:"dark"===d?(0,n.jsx)("img",{src:"whiteChain.png",className:"w-16"}):(0,n.jsx)("img",{src:"blackChain.png",className:"w-16"})}),(0,n.jsxs)("div",{className:"ml-auto",children:[(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(J.xa5,{className:"text-black dark:text-white w-5 h-auto mr-1"}),(0,n.jsx)("span",{className:"font-mono font-bold dark:text-white",children:"Wallet Address"})]}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("p",{className:"font-mono dark:text-white",children:"..."})})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(J.cf2,{className:"text-black dark:text-white w-5 h-auto mr-1"}),(0,n.jsx)("span",{className:"font-mono font-bold dark:text-white",children:"DID"})]}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("p",{className:"font-mono dark:text-white",children:"..."})})]})]})]})})})})})}var R=a(89583),q=a(1451),Q=a(6154);let $=async()=>{try{let e=await Q.Z.post("https://api.entity.hypersign.id/api/v1/app/oauth",{},{headers:{accept:"application/json","X-Api-Secret-Key":"1fae14d6e06b702c5b825e469fc2b.7e218298064c0cc5c00aedcfe73cb2c501b60cea1209245a471e4c53334c6dca457635a7884658350fe602aa21de03fbb"}});return e.data.access_token}catch(e){console.error("Error occurred:",e.message)}},ee=async(e,t)=>{try{let a=await Q.Z.post("https://api.entity.hypersign.id/api/v1/did/create",{namespace:"testnet",options:{keyType:"EcdsaSecp256k1RecoveryMethod2020",walletAddress:e,chainId:"0x1",verificationRelationships:["assertionMethod","authentication","capabilityInvocation","capabilityDelegation"]}},{headers:{accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});console.log("createDid response:",JSON.stringify(a.data,null,2));let n=a.data.metaData.didDocument,s=n["@context"];delete n["@context"],delete n.keyAgreement;let i={context:s,...n};return i}catch(e){throw console.error("API error:",e),e}},et=async(e,t,a)=>{let n={didDocument:e,signInfos:[{verification_method_id:e.verificationMethod[0].id,clientSpec:{type:"eth-personalSign"},signature:t}]};try{let e=await Q.Z.post("https://api.entity.hypersign.id/api/v1/did/register",n,{headers:{accept:"application/json",Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});return console.log("registerDid response:",e.data),e.data.did}catch(e){throw console.error("registerDID error:",e),e}},ea=async(e,t,a)=>{let n={didDocument:e,signInfos:[{verification_method_id:e.verificationMethod[0].id,clientSpec:{type:"eth-personalSign"},signature:t}],deactivate:!1};try{let e=await Q.Z.patch("https://api.entity.hypersign.id/api/v1/did",n,{headers:{accept:"application/json",Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});return console.log("updateDid response:",e.data),e.data}catch(e){throw console.error("updateDid error:",e),e}},en=async(e,t)=>{try{let a=await Q.Z.get("https://api.entity.hypersign.id/api/v1/did/resolve/".concat(e),{headers:{accept:"application/json",Authorization:"Bearer ".concat(t)}});return a.data}catch(e){console.error("Error occurred:",e.message)}},es=async(e,t,a)=>{let n=await $(),s={schemaId:"sch:hid:testnet:z2dNytfsbHiAnnx6JmC6V1T5y1sF2XXkpKAaHjAao587N:1.0",subjectDid:e,issuerDid:"did:hid:testnet:z996acTcJsUzLZb2HwPnoX9YrDmj5u41vGpWYUkTSEZMg",expirationDate:"2027-12-10T18:30:00.000Z",fields:{githubName:t.name,githubNickname:t.nickname,githubSub:t.sub,webAuthnId:a},namespace:"testnet",verificationMethodId:"did:hid:testnet:z996acTcJsUzLZb2HwPnoX9YrDmj5u41vGpWYUkTSEZMg#key-1",persist:!0};try{let e=await Q.Z.post("https://api.entity.hypersign.id/api/v1/credential/issue",s,{headers:{accept:"application/json",Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});return console.log("VC is here",e.data),e.data}catch(e){throw console.error("issue Vc error:",e),e}},ei=async e=>{let t=await $();try{let a=await Q.Z.get("https://api.entity.hypersign.id/api/v1/credential/".concat(e),{headers:{accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});return a.data.credentialStatus}catch(e){throw console.error("get Vc error:",e),e}};function er(e){var t,a;let[s,i]=(0,_.useState)(!1),{address:r,isConnected:l}=(0,z.mA)(),[o,c]=(0,_.useState)({id:"",issuanceDate:"",expirationDate:""}),d="https://explorer.hypersign.id/hypersign-testnet/revocationRegistry/".concat(o.id);(0,_.useEffect)(()=>{!async function(){var t,a,n,s;let i=await $();if(""===e.did){console.log("no did yet");return}let r=await en(e.did,i);if((null===(t=null==r?void 0:null===(a=r.didDocument)||void 0===a?void 0:a.service[0])||void 0===t?void 0:t.serviceEndpoint)===void 0)return c({id:"",issuanceDate:"",expirationDate:""}),console.log("no serviceEndpoint");let l=await ei(null===(n=null==r?void 0:null===(s=r.didDocument)||void 0===s?void 0:s.service[0])||void 0===n?void 0:n.serviceEndpoint);c({id:l.claim.id,issuanceDate:l.issuanceDate,expirationDate:l.expirationDate})}()},[l,e.did,r]);let u=()=>{let e=o.id;navigator.clipboard.writeText(e).then(()=>{i(!0),setTimeout(()=>{i(!1)},1e3)})};return(0,n.jsxs)("div",{className:"bg-gradient-to-r from-[#42275a] to-[#734b6d] card w-[350px] p-2 text-white shadow-[0_3px_10px_rgb(0,0,0,0.2)]",children:[(0,n.jsx)("div",{className:"card-body",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex flex-col items-center",children:""!==o.id&&l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.hJX,{className:"w-16 h-auto ml-auto mr-1"}),(0,n.jsx)("span",{className:"mt-2 font-bold font-mono",children:"Github"})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(q.tU0,{className:"w-16 h-auto ml-auto mr-1"})})}),(0,n.jsxs)("div",{className:"ml-auto",children:[(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(J.xa5,{className:"w-5 h-auto mr-1"}),(0,n.jsx)("span",{className:"font-mono font-bold",children:"Credentail ID"})]}),(0,n.jsx)("div",{className:"flex items-center text-[#cccccc]",children:""!==o.id&&l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"font-mono",children:W(o.id)}),s?(0,n.jsx)(L.IQF,{className:"text-green-500 w-5 h-auto ml-1"}):(0,n.jsx)(J.LhG,{className:"w-5 h-auto ml-1 cursor-pointer",onClick:()=>{e.handleCopyClick(),u()}})]}):(0,n.jsx)("p",{className:"font-mono",children:"..."})})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(R.fSQ,{className:"w-5 h-auto mr-1"}),(0,n.jsx)("p",{className:"font-mono font-bold",children:"Duration"})]}),""!==o.id&&l?(0,n.jsx)("p",{className:"font-mono tracking-tight text-[#cccccc]",children:"".concat(null==o?void 0:null===(t=o.issuanceDate)||void 0===t?void 0:t.slice(0,10),"~").concat(null==o?void 0:null===(a=o.expirationDate)||void 0===a?void 0:a.slice(0,10))}):(0,n.jsx)("p",{className:"font-mono",children:"..."})]})]})]})}),""!==o.id&&l&&(0,n.jsx)("a",{href:d,target:"_blank",rel:"noreferrer",children:(0,n.jsx)("p",{className:"font-mono absolute bottom-0.5 right-2 text-[#cccccc] text-sm",children:"more..."})})]})}let el=async e=>{try{var t,a;let n=await $(),s=await en("did:hid:testnet:"+e,n);if((null==s?void 0:null===(t=s.didDocument)||void 0===t?void 0:t.id)!==void 0)return null==s?void 0:null===(a=s.didDocument)||void 0===a?void 0:a.id;{let t=await ee(e,n),a=JSON.stringify(t),s=await (0,r.l)({message:a}),i=await et(t,s,n);return i}}catch(e){console.error("Error occurred during DID registration:",e)}};var eo=a(73606),ec=a(70112);let ed=async e=>{let t=await (0,ec.Ue)({publicKey:{challenge:G(),rp:{name:"next-webauthn",id:"bee-poll.vercel.app"},user:{id:window.crypto.randomUUID(),name:e,displayName:e},pubKeyCredParams:[{alg:-7,type:"public-key"}],timeout:6e4,attestation:"direct",authenticatorSelection:{residentKey:"required",userVerification:"required"}}});return console.log("create credential",JSON.stringify(t,null,2)),t.id},eu=async()=>{let e=await (0,ec.U2)({publicKey:{challenge:G(),timeout:6e4,userVerification:"required",rpId:"bee-poll.vercel.app"}});return console.log("credential",JSON.stringify(e,null,2)),e.id};function ep(e){let[t,a]=(0,_.useState)(""),s=async()=>{let e=await eu();console.log("localWebAuthnId",e),document&&e&&document.getElementById("my_modal_2").showModal()};async function i(){let a=JSON.parse(t),n=a.credentialStatus.credentialHash;e.setCredentialHash(n)}return(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{className:"btn btn-outline px-2 btn-info",onClick:()=>{s()},children:"Verify VC"}),(0,n.jsxs)("dialog",{id:"my_modal_2",className:"modal",children:[(0,n.jsxs)("form",{method:"dialog",className:"modal-box p-8 h-1/2 flex flex-col",children:[(0,n.jsx)("h3",{className:"font-bold text-lg text-white",children:"Please input your VC data"}),(0,n.jsx)("div",{className:"mt-5 mb-6 h-full",children:(0,n.jsx)("textarea",{className:"textarea textarea-bordered h-full w-full",placeholder:"Your VC",onChange:e=>{a(e.target.value)}})}),(0,n.jsx)("button",{className:"btn btn-outline btn-success btn-info px-2",onClick:i,children:"Verify"})]}),(0,n.jsx)("form",{method:"dialog",className:"modal-backdrop",children:(0,n.jsx)("button",{children:"close"})})]})]})}function em(e){return(0,n.jsx)("div",{children:(0,n.jsxs)("dialog",{id:"my_modal_4",className:"modal",children:[(0,n.jsxs)("form",{method:"dialog",className:"modal-box p-8 h-1/2 flex flex-col",children:[(0,n.jsx)("h3",{className:"font-bold text-lg text-white",children:"Please save your VC for verifying"}),e.vcData]}),(0,n.jsx)("form",{method:"dialog",className:"modal-backdrop",children:(0,n.jsx)("button",{children:"close"})})]})})}var eh=a(55678);a(71399);let ex=async(e,t,a)=>{try{let n=await $(),s=Z.createHash("sha256").update(a).digest("hex");console.log("hash",s);let i=await en("did:hid:testnet:"+e,n).then(e=>e.didDocument);0==i.service.length?i.service.push({id:"did:hid:testnet:z23dCariJNNpMNca86EtVZVvrLpn61isd86fWVyWa8Jkm#linked-domain",type:"LinkedDomains",serviceEndpoint:t+"#"+s}):(i.keyAgreement=[],i.service=[{id:"did:hid:testnet:z23dCariJNNpMNca86EtVZVvrLpn61isd86fWVyWa8Jkm#linked-domain",type:"LinkedDomains",serviceEndpoint:t+"#"+s}]);let l=U(JSON.parse(JSON.stringify(U(i),(e,t)=>{if(!(""===t||Array.isArray(t)&&0===t.length))return t}))),o=await (0,r.l)({message:JSON.stringify(l)}),c=await ea(l,o,n);return c}catch(e){console.error("Error occurred during DID binding:",e)}};async function ey(e,t,a){var n;console.log("create vc");let s=await ed(e);console.log("webAuthnId",s);let i=await es(e,a.user,s);console.log("vc",i);let r=i.credentialStatus.claim.id,l=null===(n=a.user)||void 0===n?void 0:n.sub;console.log("github user sub",l);let o=await ex(t,r,l);return console.log(o),{vc:i,webAuthnId:s}}let{buildPoseidon:ef}=a(52647);function eb(e){let t=(0,eo.aF)(),{address:a,isConnected:s}=(0,z.mA)(),[r,l]=(0,_.useState)(""),[o,c]=(0,_.useState)(),[d,u]=(0,_.useState)(""),[p,m]=(0,_.useState)(""),{theme:h}=(0,X.F)(),x=e=>BigInt("0x"+e).toString();(0,_.useEffect)(()=>{async function e(){let e=await el(a),t=await en(e,await $()).then(e=>null==e?void 0:e.didDocument);l(e),c(t)}s&&e()},[a,s,r]);let y=async()=>{i().push("/api/auth/login")};return(0,_.useEffect)(()=>{var e;async function n(){let e=await ey(r,a,t),n=e.vc.credentialStatus.credentialHash;m(JSON.stringify(e.vc)),document&&document.getElementById("my_modal_4").showModal();let s=await ef(),i=s.F.toString(s([x(n)]));await N(a,i),u(e.webAuthnId)}let s=null===(e=t.user)||void 0===e?void 0:e.sub;o&&o.service[0],void 0!=a&&""!=r&&void 0!=s&&n()},[y,h]),(0,n.jsxs)("div",{className:"dark:bg-slate-800",children:[(0,n.jsx)(em,{vcData:p}),(0,n.jsxs)("div",{className:"flex mt-10 w-1/2",children:[(0,n.jsx)("p",{className:"font-mono text-black font-bold text-3xl ml-5  dark:text-white",children:"IDENTITY"}),(0,n.jsxs)("div",{className:"flex space-x-4 ml-auto",children:[(0,n.jsx)(ep,{setCredentialHash:e.setCredentialHash}),(0,n.jsx)("div",{className:"tooltip","data-tip":""===r?"Connect Wallet Before Getting Credential":null,children:(0,n.jsx)("button",{className:"btn btn-outline px-2 h-1/3 btn-warning",style:{opacity:""===r?.8:1,backgroundColor:"dark"===h?"#1e293b":"#fdfdfd"},disabled:!r,onClick:()=>{y()},children:"Get Credential"})}),(0,n.jsx)(eh.Ix,{})]})]}),(0,n.jsx)("div",{className:"divider ml-5 mr-auto w-1/2 my-[0px]"}),(0,n.jsxs)("div",{className:"flex items-center mt-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-mono text-black text-xl ml-5 mt-3 mb-7 dark:text-white",children:"LINKED WALLET"}),(0,n.jsx)(K,{handleCopyClick:e.handleCopyClick,did:r})]}),(0,n.jsxs)("div",{className:"ml-7",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("span",{className:"font-mono text-black text-xl ml-5 mt-3 mb-7 dark:text-white",children:"CREDENTIALS"})}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(er,{handleCopyClick:e.handleCopyClick,did:r})})]})]})]})}function ew(){return(0,n.jsxs)("div",{className:"alert alert-success w-[230px] absolute top-0 right-0",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,n.jsx)("span",{children:"Copied to clipboard"})]})}var eg=function(){let[e,t]=(0,_.useState)(!1),[a,s]=(0,_.useState)(""),i=()=>{t(!0),setTimeout(()=>{t(!1)},1e3)},{isLoading:r}=(0,eo.aF)();return(0,n.jsxs)("div",{className:"relative dark:bg-slate-800",children:[e&&(0,n.jsx)(ew,{}),(0,n.jsx)(eb,{handleCopyClick:i,setCredentialHash:s}),a,(0,n.jsx)(F,{credentialHash:a})]})}},27790:function(){},95979:function(){},82825:function(){}},function(e){e.O(0,[792,920,808,860,68,570,13,874,433,774,888,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);