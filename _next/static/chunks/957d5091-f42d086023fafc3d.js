"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[808],{80496:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),i(42474);var r=i(47571),s=i(73461),n=i(84763),h=i(63400);function o(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var f=o(s),l=o(n);let u=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function a(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}function p(t){let e=t.toString(16);return(e.length-1)*4+u[parseInt(e[0],16)]}function m(t){return BigInt(t)<BigInt(0)}function c(t,e){return BigInt(t)<<BigInt(e)}function g(t,e){return BigInt(t)>>BigInt(e)}function F(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function d(t){let e=BigInt(t),i=[];for(;e;){if(e&BigInt(1)){let t=2-Number(e%BigInt(4));i.push(t),e-=BigInt(t)}else i.push(0);e>>=BigInt(1)}return i}function b(t){let e=BigInt(t),i=[];for(;e;)e&BigInt(1)?i.push(1):i.push(0),e>>=BigInt(1);return i}function y(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Number too big");return Number(t)}function L(t,e){return BigInt(t)+BigInt(e)}function v(t,e){return BigInt(t)-BigInt(e)}function w(t){return-BigInt(t)}function B(t,e){return BigInt(t)*BigInt(e)}function O(t,e){return BigInt(t)**BigInt(e)}function E(t,e){return BigInt(t)/BigInt(e)}function q(t,e){return BigInt(t)%BigInt(e)}function A(t,e){return BigInt(t)==BigInt(e)}function _(t,e){return BigInt(t)>BigInt(e)}function x(t,e){return BigInt(t)>=BigInt(e)}function R(t,e){return BigInt(t)&BigInt(e)}function M(t,e,i,r){let s="0000000"+i.toString(16),n=new Uint32Array(t.buffer,t.byteOffset+e,r/4),h=((s.length-7)*4-1>>5)+1;for(let t=0;t<h;t++)n[t]=parseInt(s.substring(s.length-8*t-8,s.length-8*t),16);for(let t=h;t<n.length;t++)n[t]=0;for(let e=4*n.length;e<r;e++)t[e]=y(R(g(i,8*e),255))}function I(t,e,i,r){let s="0000000"+i.toString(16),n=new DataView(t.buffer,t.byteOffset+e,r),h=((s.length-7)*4-1>>5)+1;for(let t=0;t<h;t++)n.setUint32(r-4*t-4,parseInt(s.substring(s.length-8*t-8,s.length-8*t),16),!1);for(let t=0;t<r/4-h;t++)n[t]=0}function z(t,e,i){i=i||t.byteLength,e=e||0;let r=new Uint32Array(t.buffer,t.byteOffset+e,i/4),s=Array(i/4);return r.forEach((t,e)=>s[s.length-e-1]=t.toString(16).padStart(8,"0")),a(s.join(""),16)}function S(t,e,i){i=i||t.byteLength,e=e||0;let r=new DataView(t.buffer,t.byteOffset+e,i),s=Array(i/4);for(let t=0;t<i/4;t++)s[t]=r.getUint32(4*t,!1).toString(16).padStart(8,"0");return a(s.join(""),16)}function G(t,e){return t.toString(e)}function T(t){let e=new Uint8Array(Math.floor((p(t)-1)/8)+1);return M(e,0,t,e.byteLength),e}let U=a(0),C=a(1);var N=Object.freeze({__proto__:null,fromString:a,e:a,fromArray:function(t,e){let i=BigInt(0);e=BigInt(e);for(let r=0;r<t.length;r++)i=i*e+BigInt(t[r]);return i},bitLength:p,isNegative:m,isZero:function(t){return!t},shiftLeft:c,shiftRight:g,shl:c,shr:g,isOdd:F,naf:d,bits:b,toNumber:y,toArray:function(t,e){let i=[],r=BigInt(t);for(e=BigInt(e);r;)i.unshift(Number(r%e)),r/=e;return i},add:L,sub:v,neg:w,mul:B,square:function(t){return BigInt(t)*BigInt(t)},pow:O,exp:function(t,e){return BigInt(t)**BigInt(e)},abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},div:E,mod:q,eq:A,neq:function(t,e){return BigInt(t)!=BigInt(e)},lt:function(t,e){return BigInt(t)<BigInt(e)},gt:_,leq:function(t,e){return BigInt(t)<=BigInt(e)},geq:x,band:R,bor:function(t,e){return BigInt(t)|BigInt(e)},bxor:function(t,e){return BigInt(t)^BigInt(e)},land:function(t,e){return BigInt(t)&&BigInt(e)},lor:function(t,e){return BigInt(t)||BigInt(e)},lnot:function(t){return!BigInt(t)},toRprLE:M,toRprBE:I,fromRprLE:z,fromRprBE:S,toString:G,toLEBuff:T,zero:U,one:C});function j(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function $(t,e,i,r,s){let n=1<<i;if(1==n)return[e[r]];if(2==n)return[t.F.add(e[r],e[r+s]),t.F.sub(e[r],e[r+s])];let h=n>>1,o=$(t,e,i-1,r,2*s),f=$(t,e,i-1,r+s,2*s),l=Array(n);for(let e=0;e<h;e++)l[e]=t.F.add(o[e],t.F.mul(t.roots[i][e],f[e])),l[e+h]=t.F.sub(o[e],t.F.mul(t.roots[i][e],f[e]));return l}function k(t,e,i){let r=1<<i;if(1==r)return[e[0]];let s=r>>1,n=k(t,e.slice(0,s),i-1),h=k(t,e.slice(s),i-1),o=Array(r);for(let e=0;e<s;e++)o[e]=t.F.add(n[e],t.F.mul(t.roots[i][e],h[e])),o[e+s]=t.F.sub(n[e],t.F.mul(t.roots[i][e],h[e]));return o}let Z=[];for(let t=0;t<256;t++)Z[t]=function(t,e){let i=0,r=t;for(let t=0;t<8;t++)i<<=1,i|=1&r,r>>=1;return i}(t,0);function P(t,e){for(let r=0;r<t.length;r++){var i;let s=(Z[(i=r)>>>24]|Z[i>>>16&255]<<8|Z[i>>>8&255]<<16|Z[255&i]<<24)>>>32-e;if(s>r){let e=t[r];t[r]=t[s],t[s]=e}}}function J(t,e,i){let r;if(!i)return t.zero;let s=d(i);if(1==s[s.length-1])r=e;else if(-1==s[s.length-1])r=t.neg(e);else throw Error("invlaud NAF");for(let i=s.length-2;i>=0;i--)r=t.double(r),1==s[i]?r=t.add(r,e):-1==s[i]&&(r=t.sub(r,e));return r}function Q(t,e,i){if(!i)return t.one;let r=b(i);if(0==r.length)return t.one;let s=e;for(let i=r.length-2;i>=0;i--)s=t.square(s),r[i]&&(s=t.mul(s,e));return s}function X(t){var e,i;if(t.m%2==1){if(A(q(t.p,4),1)){if(A(q(t.p,8),1)){if(A(q(t.p,16),1))!function(t){for(t.sqrt_q=O(t.p,t.m),t.sqrt_s=0,t.sqrt_t=v(t.sqrt_q,1);!F(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=E(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){let i=t.random();t.sqrt_z=t.pow(i,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=E(v(t.sqrt_t,1),2),t.sqrt=function(t){if(this.isZero(t))return this.zero;let e=this.pow(t,this.sqrt_tm1d2),i=this.pow(this.mul(this.square(e),t),2**(this.sqrt_s-1));if(this.eq(i,this.negone))return null;let r=this.sqrt_s,s=this.mul(t,e),n=this.mul(s,e),h=this.sqrt_z;for(;!this.eq(n,this.one);){let t=this.square(n),i=1;for(;!this.eq(t,this.one);)t=this.square(t),i++;e=h;for(let t=0;t<r-i-1;t++)e=this.square(e);h=this.square(e),n=this.mul(n,h),s=this.mul(s,e),r=i}return this.geq(s,this.zero)?s:this.neg(s)}}(t);else if(A(q(t.p,16),9))t.sqrt=function(){throw Error("Sqrt alg 4 not implemented")};else throw Error("Field withot sqrt")}else if(A(q(t.p,8),5))t.sqrt=function(){throw Error("Sqrt alg 3 not implemented")};else throw Error("Field withot sqrt")}else A(q(t.p,4),3)&&((e=t).sqrt_q=O(e.p,e.m),e.sqrt_e1=E(v(e.sqrt_q,3),4),e.sqrt=function(t){if(this.isZero(t))return this.zero;let i=this.pow(t,this.sqrt_e1),r=this.mul(this.square(i),t);if(this.eq(r,this.negone))return null;let s=this.mul(i,t);return e.geq(s,e.zero)?s:e.neg(s)})}else{let e=q(O(t.p,t.m/2),4);1==e?t.sqrt=function(){throw Error("Sqrt alg 10 not implemented")}:3==e?((i=t).sqrt_q=O(i.p,i.m/2),i.sqrt_e34=E(v(i.sqrt_q,3),4),i.sqrt_e12=E(v(i.sqrt_q,1),2),i.frobenius=function(t,e){return t%2==1?i.conjugate(e):e},i.sqrt=function(t){let e;let i=this.pow(t,this.sqrt_e34),r=this.mul(this.square(i),t),s=this.mul(this.frobenius(1,r),r);if(this.eq(s,this.negone))return null;let n=this.mul(i,t);if(this.eq(r,this.negone))e=this.mul(n,[this.F.zero,this.F.one]);else{let t=this.pow(this.add(this.one,r),this.sqrt_e12);e=this.mul(t,n)}return this.geq(e,this.zero)?e:this.neg(e)}):t.sqrt=function(){throw Error("Sqrt alg 8 not implemented")}}}function D(t,e,i,r,s){t[e]=t[e]+t[i]>>>0,t[s]=(t[s]^t[e])>>>0,t[s]=(t[s]<<16|t[s]>>>16&65535)>>>0,t[r]=t[r]+t[s]>>>0,t[i]=(t[i]^t[r])>>>0,t[i]=(t[i]<<12|t[i]>>>20&4095)>>>0,t[e]=t[e]+t[i]>>>0,t[s]=(t[s]^t[e])>>>0,t[s]=(t[s]<<8|t[s]>>>24&255)>>>0,t[r]=t[r]+t[s]>>>0,t[i]=(t[i]^t[r])>>>0,t[i]=(t[i]<<7|t[i]>>>25&127)>>>0}class V{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return L(B(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(1&this.nextU32())==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++){var t;D(t=this.buff,0,4,8,12),D(t,1,5,9,13),D(t,2,6,10,14),D(t,3,7,11,15),D(t,0,5,10,15),D(t,1,6,11,12),D(t,2,7,8,13),D(t,3,4,9,14)}for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}function W(t){let e=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let i=0;i<t;i++)e[i]=4294967296*Math.random()>>>0;return e}let K=null;function H(){return K||(K=new V(function(){let t=W(32),e=new Uint32Array(t.buffer),i=[];for(let t=0;t<8;t++)i.push(e[t]);return i}()))}class Y{constructor(t,e,i){this.F=e,this.G=t,this.opMulGF=i;let r=e.sqrt_t||e.t,s=e.sqrt_s||e.s,n=e.one;for(;e.eq(e.pow(n,e.half),e.one);)n=e.add(n,e.one);this.w=Array(s+1),this.wi=Array(s+1),this.w[s]=this.F.pow(n,r),this.wi[s]=this.F.inv(this.w[s]);let h=s-1;for(;h>=0;)this.w[h]=this.F.square(this.w[h+1]),this.wi[h]=this.F.square(this.wi[h+1]),h--;this.roots=[],this._setRoots(Math.min(s,15))}_setRoots(t){for(let e=t;e>=0&&!this.roots[e];e--){let t=this.F.one,i=1<<e,r=Array(i);for(let s=0;s<i;s++)r[s]=t,t=this.F.mul(t,this.w[e]);this.roots[e]=r}}fft(t){if(t.length<=1)return t;let e=tt(t.length-1)+1;if(this._setRoots(e),t.length!=1<<e)throw Error("Size must be multiple of 2");let i=te(this,t,e,0,1);return i}ifft(t){if(t.length<=1)return t;let e=tt(t.length-1)+1;this._setRoots(e);let i=1<<e;if(t.length!=i)throw Error("Size must be multiple of 2");let r=te(this,t,e,0,1),s=this.F.inv(this.F.mulScalar(this.F.one,i)),n=Array(i);for(let t=0;t<i;t++)n[t]=this.opMulGF(r[(i-t)%i],s);return n}}function tt(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function te(t,e,i,r,s){let n=1<<i;if(1==n)return[e[r]];if(2==n)return[t.G.add(e[r],e[r+s]),t.G.sub(e[r],e[r+s])];let h=n>>1,o=te(t,e,i-1,r,2*s),f=te(t,e,i-1,r+s,2*s),l=Array(n);for(let e=0;e<h;e++)l[e]=t.G.add(o[e],t.opMulGF(f[e],t.roots[i][e])),l[e+h]=t.G.sub(o[e],t.opMulGF(f[e],t.roots[i][e]));return l}class ti{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=p(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);let e=this.negone>>this.one;this.nqr=this.two;let i=this.pow(this.nqr,e);for(;!this.eq(i,this.negone);)this.nqr=this.nqr+this.one,i=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),X(this),this.FFT=new Y(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,e){let i;if(e?16==e&&(i=BigInt("0x"+t)):i=BigInt(t),!(i<0))return i>=this.p?i%this.p:i;{let t=-i;return t>=this.p&&(t%=this.p),this.p-t}}add(t,e){let i=t+e;return i>=this.p?i-this.p:i}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){let i=t>this.half?t-this.p:t,r=e>this.half?e-this.p:e;return i<r}gt(t,e){let i=t>this.half?t-this.p:t,r=e>this.half?e-this.p:e;return i>r}leq(t,e){let i=t>this.half?t-this.p:t,r=e>this.half?e-this.p:e;return i<=r}geq(t,e){let i=t>this.half?t-this.p:t,r=e>this.half?e-this.p:e;return i>=r}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw Error("Division by zero");return t/e}inv(t){if(!t)throw Error("Division by zero");let e=this.zero,i=this.p,r=this.one,s=t%this.p;for(;s;){let t=i/s;[e,r]=[r,e-t*r],[i,s]=[s,i-t*s]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return Q(this,t,e)}exp(t,e){return Q(this,t,e)}band(t,e){let i=t&e&this.mask;return i>=this.p?i-this.p:i}bor(t,e){let i=(t|e)&this.mask;return i>=this.p?i-this.p:i}bxor(t,e){let i=(t^e)&this.mask;return i>=this.p?i-this.p:i}bnot(t){let e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){let i=t<<e&this.mask;return i>=this.p?i-this.p:i}{let i=this.p-e;return Number(i)<this.bitLength?t>>i:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{let i=this.p-e;if(!(Number(i)<this.bitLength))return 0;{let e=t<<i&this.mask;return e>=this.p?e-this.p:e}}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;let e=this.pow(t,this.negone>>this.one);if(e!=this.one)return null;let i=this.s,r=this.nqr_to_t,s=this.pow(t,this.t),n=this.pow(t,this.add(this.t,this.one)>>this.one);for(;s!=this.one;){let t=this.square(s),e=1;for(;t!=this.one;)e++,t=this.square(t);let h=r;for(let t=0;t<i-e-1;t++)h=this.square(h);i=e,r=this.square(h),s=this.mul(s,r),n=this.mul(n,h)}return n>this.p>>this.one&&(n=this.neg(n)),n}normalize(t,e){if(!((t=BigInt(t,e))<0))return t>=this.p?t%this.p:t;{let e=-t;return e>=this.p&&(e%=this.p),this.p-e}}random(){let t=2*this.bitLength/8,e=this.zero;for(let i=0;i<t;i++)e=(e<<BigInt(8))+BigInt(W(1)[0]);return e%this.p}toString(t,e){let i;if(e=e||10,t>this.half&&10==e){let r=this.p-t;i="-"+r.toString(e)}else i=t.toString(e);return i}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let i=0;i<this.n64;i++)e+=t.nextU64()<<BigInt(64*i);e&=this.mask}while(e>=this.p);return e*this.Ri%this.p}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,e,i){M(t,e,i,8*this.n64)}toRprBE(t,e,i){I(t,e,i,8*this.n64)}toRprBEM(t,e,i){return this.toRprBE(t,e,this.mul(this.R,i))}toRprLEM(t,e,i){return this.toRprLE(t,e,this.mul(this.R,i))}fromRprLE(t,e){return z(t,e,this.n8)}fromRprBE(t,e){return S(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}toObject(t){return t}}function tr(t,e){if(Array.isArray(e)){for(let i=e.length-1;i>=0;i--)if(!t.F.isZero(e[i]))return tr(t.F,e[i]);return 0}{let i=t.neg(e);return _(e,i)}}function ts(t,e){let i=t;void 0===e&&0==(e=Math.floor((p(t)-1)/8)+1)&&(e=1);let r=new Uint8Array(e),s=new DataView(r.buffer),n=0;for(;n<e;)n+4<=e?(s.setUint32(n,Number(i&BigInt(4294967295)),!0),n+=4,i>>=BigInt(32)):n+2<=e?(s.setUint16(n,Number(i&BigInt(65535)),!0),n+=2,i>>=BigInt(16)):(s.setUint8(n,Number(i&BigInt(255)),!0),n+=1,i>>=BigInt(8));if(i)throw Error("Number does not fit in this length");return r}let tn=[];for(let t=0;t<256;t++)tn[t]=function(t,e){let i=0,r=t;for(let t=0;t<8;t++)i<<=1,i|=1&r,r>>=1;return i}(t,0);function th(t,e){return(tn[t>>>24]|tn[t>>>16&255]<<8|tn[t>>>8&255]<<16|tn[255&t]<<24)>>>32-e}function to(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function tf(t,e){let i=t.byteLength/e,r=to(i);if(i!=1<<r)throw Error("Invalid number of pointers");for(let s=0;s<i;s++){let i=th(s,r);if(s>i){let r=t.slice(s*e,(s+1)*e);t.set(t.slice(i*e,(i+1)*e),s*e),t.set(r,i*e)}}}function tl(t,e){let i=new Uint8Array(e*t.length);for(let r=0;r<t.length;r++)i.set(t[r],r*e);return i}function tu(t,e){let i=t.byteLength/e,r=Array(i);for(let s=0;s<i;s++)r[s]=t.slice(s*e,s*e+e);return r}var ta=Object.freeze({__proto__:null,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return z(e,0);if(Array.isArray(e))return e.map(t);{if("object"!=typeof e)return e;let i={},r=Object.keys(e);return r.forEach(r=>{i[r]=t(e[r])}),i}},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e)||"string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(t);{if("object"!=typeof e)return e;if(null===e)return null;let i={},r=Object.keys(e);return r.forEach(r=>{i[r]=t(e[r])}),i}},beBuff2int:function(t){let e=BigInt(0),i=t.length,r=0,s=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;i>0;)i>=4?(i-=4,e+=BigInt(s.getUint32(i))<<BigInt(8*r),r+=4):i>=2?(i-=2,e+=BigInt(s.getUint16(i))<<BigInt(8*r),r+=2):(i-=1,e+=BigInt(s.getUint8(i))<<BigInt(8*r),r+=1);return e},beInt2Buff:function(t,e){let i=t,r=new Uint8Array(e),s=new DataView(r.buffer),n=e;for(;n>0;)n-4>=0?(n-=4,s.setUint32(n,Number(i&BigInt(4294967295))),i>>=BigInt(32)):n-2>=0?(n-=2,s.setUint16(n,Number(i&BigInt(65535))),i>>=BigInt(16)):(n-=1,s.setUint8(n,Number(i&BigInt(255))),i>>=BigInt(8));if(i)throw Error("Number does not fit in this length");return r},leBuff2int:function(t){let e=BigInt(0),i=0,r=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;i<t.length;)i+4<=t.length?(e+=BigInt(r.getUint32(i,!0))<<BigInt(8*i),i+=4):i+2<=t.length?(e+=BigInt(r.getUint16(i,!0))<<BigInt(8*i),i+=2):(e+=BigInt(r.getUint8(i,!0))<<BigInt(8*i),i+=1);return e},leInt2Buff:ts,stringifyFElements:function t(e,i){if("bigint"==typeof i||void 0!==i.eq)return i.toString(10);if(i instanceof Uint8Array)return e.toString(e.e(i));if(Array.isArray(i))return i.map(t.bind(this,e));{if("object"!=typeof i)return i;let r={},s=Object.keys(i);return s.forEach(s=>{r[s]=t(e,i[s])}),r}},unstringifyFElements:function t(e,i){if("string"==typeof i&&/^[0-9]+$/.test(i)||"string"==typeof i&&/^0x[0-9a-fA-F]+$/.test(i))return e.e(i);if(Array.isArray(i))return i.map(t.bind(this,e));{if("object"!=typeof i)return i;if(null===i)return null;let r={},s=Object.keys(i);return s.forEach(s=>{r[s]=t(e,i[s])}),r}},bitReverse:th,log2:to,buffReverseBits:tf,array2buffer:tl,buffer2array:tu});class tp{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=1073741824){let i=Math.min(t-e,1073741824);this.buffers.push(new Uint8Array(i))}}slice(t,e){let i;void 0===e&&(e=this.byteLength),void 0===t&&(t=0);let r=e-t,s=Math.floor(t/1073741824),n=Math.floor((t+r-1)/1073741824);if(s==n||0==r)return this.buffers[s].slice(t%1073741824,t%1073741824+r);let h=s,o=t%1073741824,f=r;for(;f>0;){let t=o+f>1073741824?1073741824-o:f,e=new Uint8Array(this.buffers[h].buffer,this.buffers[h].byteOffset+o,t);if(t==r)return e.slice();i||(i=r<=1073741824?new Uint8Array(r):new tp(r)),i.set(e,r-f),f-=t,h++,o=0}return i}set(t,e){void 0===e&&(e=0);let i=t.byteLength;if(0==i)return;let r=Math.floor(e/1073741824),s=Math.floor((e+i-1)/1073741824);if(r==s)return t instanceof tp&&1==t.buffers.length?this.buffers[r].set(t.buffers[0],e%1073741824):this.buffers[r].set(t,e%1073741824);let n=r,h=e%1073741824,o=i;for(;o>0;){let e=h+o>1073741824?1073741824-h:o,r=t.slice(i-o,i-o+e),s=new Uint8Array(this.buffers[n].buffer,this.buffers[n].byteOffset+h,e);s.set(r),o-=e,n++,h=0}}}function tm(t,e,i,r){return async function(s){let n;let h=Math.floor(s.byteLength/i);if(h*i!==s.byteLength)throw Error("Invalid buffer size");let o=Math.floor(h/t.concurrency),f=[];for(let n=0;n<t.concurrency;n++){let l;if(0==(l=n<t.concurrency-1?o:h-n*o))continue;let u=s.slice(n*o*i,n*o*i+l*i),a=[{cmd:"ALLOCSET",var:0,buff:u},{cmd:"ALLOC",var:1,len:r*l},{cmd:"CALL",fnName:e,params:[{var:0},{val:l},{var:1}]},{cmd:"GET",out:0,var:1,len:r*l}];f.push(t.queueAction(a))}let l=await Promise.all(f);n=s instanceof tp?new tp(h*r):new Uint8Array(h*r);let u=0;for(let t=0;t<l.length;t++)n.set(l[t][0],u),u+=l[t][0].byteLength;return n}}class tc{constructor(t,e,i,r){if(this.tm=t,this.prefix=e,this.p=r,this.n8=i,this.type="F1",this.m=1,this.half=g(r,C),this.bitLength=p(r),this.mask=v(c(C,this.bitLength),C),this.pOp1=t.alloc(i),this.pOp2=t.alloc(i),this.pOp3=t.alloc(i),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(i/8),this.n32=Math.floor(i/4),8*this.n64!=this.n8)throw Error("n8 must be a multiple of 8");this.half=g(this.p,C),this.nqr=this.two;let s=this.exp(this.nqr,this.half);for(;!this.eq(s,this.negone);)this.nqr=this.add(this.nqr,this.one),s=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let n=v(this.p,C);for(;!F(n);)this.s=this.s+1,n=g(n,C);this.w=[],this.w[this.s]=this.exp(this.nqr,n);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw Error("Error calculating roots of unity");this.batchToMontgomery=tm(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=tm(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=T(a(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let i=a(t,e);m(i)?(_(i=w(i),this.p)&&(i=q(i,this.p)),i=v(this.p,i)):_(i,this.p)&&(i=q(i,this.p));let r=ts(i,this.n8);return this.toMontgomery(r)}toString(t,e){let i=this.fromMontgomery(t),r=z(i,0);return G(r,e)}fromRng(t){let e;let i=new Uint8Array(this.n8);do{e=U;for(let i=0;i<this.n64;i++)e=L(e,c(t.nextU64(),64*i));e=R(e,this.mask)}while(x(e,this.p));return M(i,0,e,this.n8),i}random(){return this.fromRng(H())}toObject(t){let e=this.fromMontgomery(t);return z(e,0)}fromObject(t){let e=new Uint8Array(this.n8);return M(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,i){t.set(this.fromMontgomery(i),e)}toRprBE(t,e,i){let r=this.fromMontgomery(i);for(let t=0;t<this.n8/2;t++){let e=r[t];r[t]=r[this.n8-1-t],r[this.n8-1-t]=e}t.set(r,e)}fromRprLE(t,e){e=e||0;let i=t.slice(e,e+this.n8);return this.toMontgomery(i)}async batchInverse(t){let e,i=!1,r=this.n8,s=this.n8;Array.isArray(t)?(t=tl(t,r),i=!0):t=t.slice(0,t.byteLength);let n=Math.floor(t.byteLength/r);if(n*r!==t.byteLength)throw Error("Invalid buffer size");let h=Math.floor(n/this.tm.concurrency),o=[];for(let e=0;e<this.tm.concurrency;e++){let i;if(0==(i=e<this.tm.concurrency-1?h:n-e*h))continue;let f=t.slice(e*h*r,e*h*r+i*r),l=[{cmd:"ALLOCSET",var:0,buff:f},{cmd:"ALLOC",var:1,len:s*i},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:r},{val:i},{var:1},{val:s}]},{cmd:"GET",out:0,var:1,len:s*i}];o.push(this.tm.queueAction(l))}let f=await Promise.all(o);e=t instanceof tp?new tp(n*s):new Uint8Array(n*s);let l=0;for(let t=0;t<f.length;t++)e.set(f[t][0],l),l+=f[t][0].byteLength;return i?tu(e,s):e}}class tg{constructor(t,e,i){this.tm=t,this.prefix=e,this.F=i,this.type="F2",this.m=2*i.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*i.n8),this.pOp2=t.alloc(2*i.n8),this.pOp3=t.alloc(2*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=T(a(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){let i=this.F.e(t[0],e),r=this.F.e(t[1],e),s=new Uint8Array(2*this.F.n8);return s.set(i),s.set(r,2*this.F.n8),s}throw Error("invalid F2")}toString(t,e){let i=this.F.toString(t.slice(0,this.F.n8),e),r=this.F.toString(t.slice(this.F.n8),e);return`[${i}, ${r}]`}fromRng(t){let e=this.F.fromRng(t),i=this.F.fromRng(t),r=new Uint8Array(2*this.F.n8);return r.set(e),r.set(i,this.F.n8),r}random(){return this.fromRng(H())}toObject(t){let e=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));return[e,i]}fromObject(t){let e=new Uint8Array(2*this.F.n8),i=this.F.fromObject(t[0]),r=this.F.fromObject(t[1]);return e.set(i),e.set(r,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class tF{constructor(t,e,i){this.tm=t,this.prefix=e,this.F=i,this.type="F3",this.m=3*i.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*i.n8),this.pOp2=t.alloc(3*i.n8),this.pOp3=t.alloc(3*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=T(a(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){let i=this.F.e(t[0],e),r=this.F.e(t[1],e),s=this.F.e(t[2],e),n=new Uint8Array(3*this.F.n8);return n.set(i),n.set(r,this.F.n8),n.set(s,2*this.F.n8),n}throw Error("invalid F3")}toString(t,e){let i=this.F.toString(t.slice(0,this.F.n8),e),r=this.F.toString(t.slice(this.F.n8,2*this.F.n8),e),s=this.F.toString(t.slice(2*this.F.n8),e);return`[${i}, ${r}, ${s}]`}fromRng(t){let e=this.F.fromRng(t),i=this.F.fromRng(t),r=this.F.fromRng(t),s=new Uint8Array(3*this.F.n8);return s.set(e),s.set(i,this.F.n8),s.set(r,2*this.F.n8),s}random(){return this.fromRng(H())}toObject(t){let e=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),r=this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8));return[e,i,r]}fromObject(t){let e=new Uint8Array(3*this.F.n8),i=this.F.fromObject(t[0]),r=this.F.fromObject(t[1]),s=this.F.fromObject(t[2]);return e.set(i),e.set(r,this.F.n8),e.set(s,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class td{constructor(t,e,i,r,s,n){this.tm=t,this.prefix=e,this.F=i,this.pOp1=t.alloc(3*i.n8),this.pOp2=t.alloc(3*i.n8),this.pOp3=t.alloc(3*i.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*i.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*i.n8),this.one=this.tm.getBuff(r,3*i.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(r,2*i.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(s,i.n8),n&&(this.cofactor=T(n)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=tm(t,e+"_batchLEMtoC",2*i.n8,i.n8),this.batchLEMtoU=tm(t,e+"_batchLEMtoU",2*i.n8,2*i.n8),this.batchCtoLEM=tm(t,e+"_batchCtoLEM",i.n8,2*i.n8),this.batchUtoLEM=tm(t,e+"_batchUtoLEM",2*i.n8,2*i.n8),this.batchToJacobian=tm(t,e+"_batchToJacobian",2*i.n8,3*i.n8),this.batchToAffine=tm(t,e+"_batchToAffine",3*i.n8,2*i.n8)}op2(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,i){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,i),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e)}throw Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e)}throw Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw Error("invalid point size")}timesScalar(t,e){let i;if(e instanceof Uint8Array||(e=T(a(e))),t.byteLength==3*this.F.n8)i=this.prefix+"_timesScalar";else if(t.byteLength==2*this.F.n8)i=this.prefix+"_timesScalarAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[i](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let i;if(t.byteLength==3*this.F.n8)i=this.prefix+"_timesFr";else if(t.byteLength==2*this.F.n8)i=this.prefix+"_timesFrAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[i](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e)}throw Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw Error("invalid point size")}toRprUncompressed(t,e,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let r=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(r,e)}fromRprUncompressed(t,e){let i=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,i){if(this.tm.setBuff(this.pOp1,i),i.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(i.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let r=this.tm.getBuff(this.pOp1,this.F.n8);t.set(r,e)}fromRprCompressed(t,e){let i=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){let e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,i){if(i.byteLength==2*this.F.n8){t.set(i,e);return}if(i.byteLength==3*this.F.n8){this.tm.setBuff(this.pOp1,i),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let r=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(r,e)}else throw Error("invalid point size")}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){let i=this.F.toString(t.slice(0,this.F.n8),e),r=this.F.toString(t.slice(this.F.n8,2*this.F.n8),e),s=this.F.toString(t.slice(2*this.F.n8),e);return`[ ${i}, ${r}, ${s} ]`}if(t.byteLength==2*this.F.n8){let i=this.F.toString(t.slice(0,this.F.n8),e),r=this.F.toString(t.slice(this.F.n8),e);return`[ ${i}, ${r} ]`}throw Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let e=this.F,i=this.toAffine(t),r=i.slice(0,this.F.n8),s=i.slice(this.F.n8,2*this.F.n8),n=e.add(e.mul(e.square(r),r),this.b),h=e.square(s);return e.eq(n,h)}fromRng(t){let e,i;let r=this.F,s=[];do s[0]=r.fromRng(t),e=t.nextBool(),i=r.add(r.mul(r.square(s[0]),s[0]),this.b);while(!r.isSquare(i));s[1]=r.sqrt(i);let n=r.isNegative(s[1]);e^n&&(s[1]=r.neg(s[1]));let h=new Uint8Array(2*this.F.n8);return h.set(s[0]),h.set(s[1],this.F.n8),this.cofactor&&(h=this.timesScalar(h,this.cofactor)),h}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];let e=this.F.toObject(t.slice(0,this.F.n8)),i=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));return[e,i,t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one)]}fromObject(t){let e;let i=this.F.fromObject(t[0]),r=this.F.fromObject(t[1]);if(e=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(e,this.F.one))return this.zeroAffine;if(this.F.eq(e,this.F.one)){let t=new Uint8Array(2*this.F.n8);return t.set(i),t.set(r,this.F.n8),t}{let t=new Uint8Array(3*this.F.n8);return t.set(i),t.set(r,this.F.n8),t.set(e,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){let e=this.toAffine(t);return e.slice(0,this.F.n8)}y(t){let e=this.toAffine(t);return e.slice(this.F.n8)}}function tb(t){let e,i;async function r(t){let r=new Uint8Array(t.code),s=await WebAssembly.compile(r);i=new WebAssembly.Memory({initial:t.init,maximum:32767}),e=await WebAssembly.instantiate(s,{env:{memory:i}})}function s(t){let e=new Uint32Array(i.buffer,0,1);for(;3&e[0];)e[0]++;let r=e[0];if(e[0]+=t,e[0]+t>i.buffer.byteLength){let r=i.buffer.byteLength/65536,s=Math.floor((e[0]+t)/65536)+1;s>32767&&(s=32767),i.grow(s-r)}return r}function n(t,e){let r=new Uint8Array(i.buffer);r.set(new Uint8Array(e),t)}function h(t){if("INIT"==t[0].cmd)return r(t[0]);let h={vars:[],out:[]},o=new Uint32Array(i.buffer,0,1),f=o[0];for(let r=0;r<t.length;r++)switch(t[r].cmd){case"ALLOCSET":h.vars[t[r].var]=function(t){let e=s(t.byteLength);return n(e,t),e}(t[r].buff);break;case"ALLOC":h.vars[t[r].var]=s(t[r].len);break;case"SET":n(h.vars[t[r].var],t[r].buff);break;case"CALL":{let i=[];for(let e=0;e<t[r].params.length;e++){let s=t[r].params[e];void 0!==s.var?i.push(h.vars[s.var]+(s.offset||0)):void 0!==s.val&&i.push(s.val)}e.exports[t[r].fnName](...i);break}case"GET":h.out[t[r].out]=(function(t,e){let r=new Uint8Array(i.buffer);return new Uint8Array(r.buffer,r.byteOffset+t,e)})(h.vars[t[r].var],t[r].len).slice();break;default:throw Error("Invalid cmd")}let l=new Uint32Array(i.buffer,0,1);return l[0]=f,h.out}return t&&(t.onmessage=function(e){let i;if("INIT"==(i=e.data?e.data:e)[0].cmd)r(i[0]).then(function(){t.postMessage(i.result)});else if("TERMINATE"==i[0].cmd)t.close();else{let e=h(i);t.postMessage(e)}}),h}class ty{constructor(){this.promise=new Promise((t,e)=>{this.reject=e,this.resolve=t})}}let tL=globalThis.btoa("("+tb.toString()+")(self)"),tv="data:application/javascript;base64,"+tL;async function tw(t,e){let i=new tB;i.memory=new WebAssembly.Memory({initial:25}),i.u8=new Uint8Array(i.memory.buffer),i.u32=new Uint32Array(i.memory.buffer);let r=await WebAssembly.compile(t.code);if(i.instance=await WebAssembly.instantiate(r,{env:{memory:i.memory}}),i.singleThread=e,i.initalPFree=i.u32[0],i.pq=t.pq,i.pr=t.pr,i.pG1gen=t.pG1gen,i.pG1zero=t.pG1zero,i.pG2gen=t.pG2gen,i.pG2zero=t.pG2zero,i.pOneT=t.pOneT,e)i.code=t.code,i.taskManager=tb(),await i.taskManager([{cmd:"INIT",init:25,code:i.code.slice()}]),i.concurrency=1;else{let e;i.workers=[],i.pendingDeferreds=[],i.working=[],0==(e="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:f.default.cpus().length)&&(e=2),e>64&&(e=64),i.concurrency=e;for(let t=0;t<e;t++)i.workers[t]=new l.default(tv),i.workers[t].addEventListener("message",function(t){return function(e){let r;r=e&&e.data?e.data:e,i.working[t]=!1,i.pendingDeferreds[t].resolve(r),i.processWorks()}}(t)),i.working[t]=!1;let r=[];for(let e=0;e<i.workers.length;e++){let s=t.code.slice();r.push(i.postAction(e,[{cmd:"INIT",init:25,code:s}],[s.buffer]))}await Promise.all(r)}return i}class tB{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,i,r){if(this.working[t])throw Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=r||new ty,this.workers[t].postMessage(e,i),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(!1==this.working[t]){let e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){let i=new ty;if(this.singleThread){let e=this.taskManager(t);i.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:i}),this.processWorks();return i.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;let e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await new Promise(t=>setTimeout(t,200))}}function tO(t,e){let i=t[e],r=t.Fr,s=t.tm;t[e].batchApplyKey=async function(t,n,h,o,f){let l,u,a,p,m,c;if(o=o||"affine",f=f||"affine","G1"==e)"jacobian"==o?(a=3*i.F.n8,l="g1m_batchApplyKey"):(a=2*i.F.n8,l="g1m_batchApplyKeyMixed"),p=3*i.F.n8,"jacobian"==f?m=3*i.F.n8:(u="g1m_batchToAffine",m=2*i.F.n8);else if("G2"==e)"jacobian"==o?(a=3*i.F.n8,l="g2m_batchApplyKey"):(a=2*i.F.n8,l="g2m_batchApplyKeyMixed"),p=3*i.F.n8,"jacobian"==f?m=3*i.F.n8:(u="g2m_batchToAffine",m=2*i.F.n8);else if("Fr"==e)l="frm_batchApplyKey",a=i.n8,p=i.n8,m=i.n8;else throw Error("Invalid group: "+e);let g=Math.floor(t.byteLength/a),F=Math.floor(g/s.concurrency),d=[];h=r.e(h);let b=r.e(n);for(let e=0;e<s.concurrency;e++){let i;if(0==(i=e<s.concurrency-1?F:g-e*F))continue;let n=[];n.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*F*a,e*F*a+i*a)}),n.push({cmd:"ALLOCSET",var:1,buff:b}),n.push({cmd:"ALLOCSET",var:2,buff:h}),n.push({cmd:"ALLOC",var:3,len:i*Math.max(p,m)}),n.push({cmd:"CALL",fnName:l,params:[{var:0},{val:i},{var:1},{var:2},{var:3}]}),u&&n.push({cmd:"CALL",fnName:u,params:[{var:3},{val:i},{var:3}]}),n.push({cmd:"GET",out:0,var:3,len:i*m}),d.push(s.queueAction(n)),b=r.mul(b,r.exp(h,i))}let y=await Promise.all(d);c=t instanceof tp?new tp(g*m):new Uint8Array(g*m);let L=0;for(let t=0;t<y.length;t++)c.set(y[t][0],L),L+=y[t][0].byteLength;return c}}let tE=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function tq(t,e){let i=t[e],r=i.tm;async function s(t,r,s,n,h){let o,f;if(!(t instanceof Uint8Array))throw n&&n.error(`${h} _multiExpChunk buffBases is not Uint8Array`),Error(`${h} _multiExpChunk buffBases is not Uint8Array`);if(!(r instanceof Uint8Array))throw n&&n.error(`${h} _multiExpChunk buffScalars is not Uint8Array`),Error(`${h} _multiExpChunk buffScalars is not Uint8Array`);if(s=s||"affine","G1"==e)"affine"==s?(f="g1m_multiexpAffine_chunk",o=2*i.F.n8):(f="g1m_multiexp_chunk",o=3*i.F.n8);else if("G2"==e)"affine"==s?(f="g2m_multiexpAffine_chunk",o=2*i.F.n8):(f="g2m_multiexp_chunk",o=3*i.F.n8);else throw Error("Invalid group");let l=Math.floor(t.byteLength/o);if(0==l)return i.zero;let u=Math.floor(r.byteLength/l);if(u*l!=r.byteLength)throw Error("Scalar size does not match");let a=tE[to(l)],p=Math.floor((8*u-1)/a)+1,m=[];for(let e=0;e<p;e++){let s=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:r},{cmd:"ALLOC",var:2,len:3*i.F.n8},{cmd:"CALL",fnName:f,params:[{var:0},{var:1},{val:u},{val:l},{val:e*a},{val:Math.min(8*u-e*a,a)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*i.F.n8}];m.push(i.tm.queueAction(s))}let c=await Promise.all(m),g=i.zero;for(let t=c.length-1;t>=0;t--){if(!i.isZero(g))for(let t=0;t<a;t++)g=i.double(g);g=i.add(g,c[t][0])}return g}async function n(t,n,h,o,f){let l,u;if("G1"==e)l="affine"==h?2*i.F.n8:3*i.F.n8;else if("G2"==e)l="affine"==h?2*i.F.n8:3*i.F.n8;else throw Error("Invalid group");let a=Math.floor(t.byteLength/l),p=Math.floor(n.byteLength/a);if(p*a!=n.byteLength)throw Error("Scalar size does not match");let m=tE[to(a)];(u=Math.floor(a/(r.concurrency/(Math.floor((8*p-1)/m)+1))))>4194304&&(u=4194304),u<1024&&(u=1024);let c=[];for(let e=0;e<a;e+=u){o&&o.debug(`Multiexp start: ${f}: ${e}/${a}`);let i=Math.min(a-e,u),r=t.slice(e*l,(e+i)*l),m=n.slice(e*p,(e+i)*p);c.push(s(r,m,h,o,f).then(t=>(o&&o.debug(`Multiexp end: ${f}: ${e}/${a}`),t)))}let g=await Promise.all(c),F=i.zero;for(let t=g.length-1;t>=0;t--)F=i.add(F,g[t]);return F}i.multiExp=async function(t,e,i,r){return await n(t,e,"jacobian",i,r)},i.multiExpAffine=async function(t,e,i,r){return await n(t,e,"affine",i,r)}}function tA(t,e){let i=t[e],r=t.Fr,s=i.tm;async function n(t,n,f,l,u,a){let p,m,c,g,F,d,b,y,L,v,w;f=f||"affine",l=l||"affine","G1"==e?("affine"==f?(p=2*i.F.n8,g="g1m_batchToJacobian"):p=3*i.F.n8,m=3*i.F.n8,n&&(y="g1m_fftFinal"),b="g1m_fftJoin",d="g1m_fftMix","affine"==l?(c=2*i.F.n8,F="g1m_batchToAffine"):c=3*i.F.n8):"G2"==e?("affine"==f?(p=2*i.F.n8,g="g2m_batchToJacobian"):p=3*i.F.n8,m=3*i.F.n8,n&&(y="g2m_fftFinal"),b="g2m_fftJoin",d="g2m_fftMix","affine"==l?(c=2*i.F.n8,F="g2m_batchToAffine"):c=3*i.F.n8):"Fr"==e&&(p=i.n8,m=i.n8,c=i.n8,n&&(y="frm_fftFinal"),d="frm_fftMix",b="frm_fftJoin");let B=!1;Array.isArray(t)?(t=tl(t,p),B=!0):t=t.slice(0,t.byteLength);let O=t.byteLength/p,E=to(O);if(1<<E!=O)throw Error("fft must be multiple of 2");if(E==r.s+1){let e;return(e=n?await o(t,f,l,u,a):await h(t,f,l,u,a),B)?tu(e,c):e}n&&(L=r.inv(r.e(O))),tf(t,p);let q=Math.min(16384,O),A=O/q;for(;A<s.concurrency&&q>=16;)A*=2,q/=2;let _=to(q),x=[];for(let e=0;e<A;e++){u&&u.debug(`${a}: fft ${E} mix start: ${e}/${A}`);let i=[];i.push({cmd:"ALLOC",var:0,len:m*q});let r=t.slice(q*e*p,q*(e+1)*p);i.push({cmd:"SET",var:0,buff:r}),g&&i.push({cmd:"CALL",fnName:g,params:[{var:0},{val:q},{var:0}]});for(let t=1;t<=_;t++)i.push({cmd:"CALL",fnName:d,params:[{var:0},{val:q},{val:t}]});_==E?(y&&(i.push({cmd:"ALLOCSET",var:1,buff:L}),i.push({cmd:"CALL",fnName:y,params:[{var:0},{val:q},{var:1}]})),F&&i.push({cmd:"CALL",fnName:F,params:[{var:0},{val:q},{var:0}]}),i.push({cmd:"GET",out:0,var:0,len:q*c})):i.push({cmd:"GET",out:0,var:0,len:m*q}),x.push(s.queueAction(i).then(t=>(u&&u.debug(`${a}: fft ${E} mix end: ${e}/${A}`),t)))}w=await Promise.all(x);for(let t=0;t<A;t++)w[t]=w[t][0];for(let t=_+1;t<=E;t++){u&&u.debug(`${a}: fft  ${E}  join: ${t}/${E}`);let e=1<<E-t,i=A/e,n=[];for(let h=0;h<e;h++)for(let o=0;o<i/2;o++){let f=r.exp(r.w[t],o*q),l=r.w[t],p=h*i+o,g=h*i+o+i/2,d=[];d.push({cmd:"ALLOCSET",var:0,buff:w[p]}),d.push({cmd:"ALLOCSET",var:1,buff:w[g]}),d.push({cmd:"ALLOCSET",var:2,buff:f}),d.push({cmd:"ALLOCSET",var:3,buff:l}),d.push({cmd:"CALL",fnName:b,params:[{var:0},{var:1},{val:q},{var:2},{var:3}]}),t==E?(y&&(d.push({cmd:"ALLOCSET",var:4,buff:L}),d.push({cmd:"CALL",fnName:y,params:[{var:0},{val:q},{var:4}]}),d.push({cmd:"CALL",fnName:y,params:[{var:1},{val:q},{var:4}]})),F&&(d.push({cmd:"CALL",fnName:F,params:[{var:0},{val:q},{var:0}]}),d.push({cmd:"CALL",fnName:F,params:[{var:1},{val:q},{var:1}]})),d.push({cmd:"GET",out:0,var:0,len:q*c}),d.push({cmd:"GET",out:1,var:1,len:q*c})):(d.push({cmd:"GET",out:0,var:0,len:q*m}),d.push({cmd:"GET",out:1,var:1,len:q*m})),n.push(s.queueAction(d).then(r=>(u&&u.debug(`${a}: fft ${E} join  ${t}/${E}  ${h+1}/${e} ${o}/${i/2}`),r)))}let h=await Promise.all(n);for(let t=0;t<e;t++)for(let e=0;e<i/2;e++){let r=t*i+e,s=t*i+e+i/2,n=h.shift();w[r]=n[0],w[s]=n[1]}}if(v=t instanceof tp?new tp(O*c):new Uint8Array(O*c),n){v.set(w[0].slice((q-1)*c));let t=c;for(let e=A-1;e>0;e--)v.set(w[e],t),t+=q*c,delete w[e];v.set(w[0].slice(0,(q-1)*c),t),delete w[0]}else for(let t=0;t<A;t++)v.set(w[t],q*c*t),delete w[t];return B?tu(v,c):v}async function h(t,e,i,s,h){let o,l,u;o=t.slice(0,t.byteLength/2),l=t.slice(t.byteLength/2,t.byteLength);let a=[];[o,l]=await f(o,l,"fftJoinExt",r.one,r.shift,e,"jacobian",s,h),a.push(n(o,!1,"jacobian",i,s,h)),a.push(n(l,!1,"jacobian",i,s,h));let p=await Promise.all(a);return(u=p[0].byteLength>268435456?new tp(2*p[0].byteLength):new Uint8Array(2*p[0].byteLength)).set(p[0]),u.set(p[1],p[0].byteLength),u}async function o(t,e,i,s,h){let o,l,u;o=t.slice(0,t.byteLength/2),l=t.slice(t.byteLength/2,t.byteLength);let a=[];a.push(n(o,!0,e,"jacobian",s,h)),a.push(n(l,!0,e,"jacobian",s,h)),[o,l]=await Promise.all(a);let p=await f(o,l,"fftJoinExtInv",r.one,r.shiftInv,"jacobian",i,s,h);return(u=p[0].byteLength>268435456?new tp(2*p[0].byteLength):new Uint8Array(2*p[0].byteLength)).set(p[0]),u.set(p[1],p[0].byteLength),u}async function f(t,n,h,o,f,l,u,a,p){let m,c,g,F,d,b,y,L;if("G1"==e)"affine"==l?(d=2*i.F.n8,c="g1m_batchToJacobian"):d=3*i.F.n8,b=3*i.F.n8,m="g1m_"+h,"affine"==u?(g="g1m_batchToAffine",F=2*i.F.n8):F=3*i.F.n8;else if("G2"==e)"affine"==l?(d=2*i.F.n8,c="g2m_batchToJacobian"):d=3*i.F.n8,m="g2m_"+h,b=3*i.F.n8,"affine"==u?(g="g2m_batchToAffine",F=2*i.F.n8):F=3*i.F.n8;else if("Fr"==e)d=r.n8,F=r.n8,b=r.n8,m="frm_"+h;else throw Error("Invalid group");if(t.byteLength!=n.byteLength)throw Error("Invalid buffer size");let v=Math.floor(t.byteLength/d);if(v!=1<<to(v))throw Error("Invalid number of points");let w=Math.floor(v/s.concurrency);w<16&&(w=16),w>65536&&(w=65536);let B=[];for(let e=0;e<v;e+=w){a&&a.debug(`${p}: fftJoinExt Start: ${e}/${v}`);let i=Math.min(v-e,w),h=r.mul(o,r.exp(f,e)),l=[],u=t.slice(e*d,(e+i)*d),y=n.slice(e*d,(e+i)*d);l.push({cmd:"ALLOC",var:0,len:b*i}),l.push({cmd:"SET",var:0,buff:u}),l.push({cmd:"ALLOC",var:1,len:b*i}),l.push({cmd:"SET",var:1,buff:y}),l.push({cmd:"ALLOCSET",var:2,buff:h}),l.push({cmd:"ALLOCSET",var:3,buff:f}),c&&(l.push({cmd:"CALL",fnName:c,params:[{var:0},{val:i},{var:0}]}),l.push({cmd:"CALL",fnName:c,params:[{var:1},{val:i},{var:1}]})),l.push({cmd:"CALL",fnName:m,params:[{var:0},{var:1},{val:i},{var:2},{var:3},{val:r.s}]}),g&&(l.push({cmd:"CALL",fnName:g,params:[{var:0},{val:i},{var:0}]}),l.push({cmd:"CALL",fnName:g,params:[{var:1},{val:i},{var:1}]})),l.push({cmd:"GET",out:0,var:0,len:i*F}),l.push({cmd:"GET",out:1,var:1,len:i*F}),B.push(s.queueAction(l).then(t=>(a&&a.debug(`${p}: fftJoinExt End: ${e}/${v}`),t)))}let O=await Promise.all(B);v*F>268435456?(y=new tp(v*F),L=new tp(v*F)):(y=new Uint8Array(v*F),L=new Uint8Array(v*F));let E=0;for(let t=0;t<O.length;t++)y.set(O[t][0],E),L.set(O[t][1],E),E+=O[t][0].byteLength;return[y,L]}i.fft=async function(t,e,i,r,s){return await n(t,!1,e,i,r,s)},i.ifft=async function(t,e,i,r,s){return await n(t,!0,e,i,r,s)},i.lagrangeEvaluations=async function(t,s,h,o,l){let u,a;if(s=s||"affine",h=h||"affine","G1"==e)u="affine"==s?2*i.F.n8:3*i.F.n8;else if("G2"==e)u="affine"==s?2*i.F.n8:3*i.F.n8;else if("Fr"==e)u=r.n8;else throw Error("Invalid group");let p=t.byteLength/u,m=to(p);if(2**m*u!=t.byteLength)throw o&&o.error("lagrangeEvaluations iinvalid input size"),Error("lagrangeEvaluations invalid Input size");if(m<=r.s)return await i.ifft(t,s,h,o,l);if(m>r.s+1)throw o&&o.error("lagrangeEvaluations input too big"),Error("lagrangeEvaluations input too big");let c=t.slice(0,t.byteLength/2),g=t.slice(t.byteLength/2,t.byteLength),F=r.exp(r.shift,p/2),d=r.inv(r.sub(r.one,F));[c,g]=await f(c,g,"prepareLagrangeEvaluation",d,r.shiftInv,s,"jacobian",o,l+" prep");let b=[];return b.push(n(c,!0,"jacobian",h,o,l+" t0")),b.push(n(g,!0,"jacobian",h,o,l+" t1")),[c,g]=await Promise.all(b),(a=c.byteLength>268435456?new tp(2*c.byteLength):new Uint8Array(2*c.byteLength)).set(c),a.set(g,c.byteLength),a},i.fftMix=async function(t){let n,h,o;let f=3*i.F.n8;if("G1"==e)n="g1m_fftMix",h="g1m_fftJoin";else if("G2"==e)n="g2m_fftMix",h="g2m_fftJoin";else if("Fr"==e)n="frm_fftMix",h="frm_fftJoin";else throw Error("Invalid group");let l=Math.floor(t.byteLength/f),u=to(l),a=1<<to(s.concurrency);l<=2*a&&(a=1);let p=l/a,m=to(p),c=[];for(let e=0;e<a;e++){let i=[],r=t.slice(e*p*f,(e+1)*p*f);i.push({cmd:"ALLOCSET",var:0,buff:r});for(let t=1;t<=m;t++)i.push({cmd:"CALL",fnName:n,params:[{var:0},{val:p},{val:t}]});i.push({cmd:"GET",out:0,var:0,len:p*f}),c.push(s.queueAction(i))}let g=await Promise.all(c),F=[];for(let t=0;t<g.length;t++)F[t]=g[t][0];for(let t=m+1;t<=u;t++){let e=1<<u-t,i=a/e,n=[];for(let o=0;o<e;o++)for(let e=0;e<i/2;e++){let l=r.exp(r.w[t],e*p),u=r.w[t],a=o*i+e,m=o*i+e+i/2,c=[];c.push({cmd:"ALLOCSET",var:0,buff:F[a]}),c.push({cmd:"ALLOCSET",var:1,buff:F[m]}),c.push({cmd:"ALLOCSET",var:2,buff:l}),c.push({cmd:"ALLOCSET",var:3,buff:u}),c.push({cmd:"CALL",fnName:h,params:[{var:0},{var:1},{val:p},{var:2},{var:3}]}),c.push({cmd:"GET",out:0,var:0,len:p*f}),c.push({cmd:"GET",out:1,var:1,len:p*f}),n.push(s.queueAction(c))}let o=await Promise.all(n);for(let t=0;t<e;t++)for(let e=0;e<i/2;e++){let r=t*i+e,s=t*i+e+i/2,n=o.shift();F[r]=n[0],F[s]=n[1]}}o=t instanceof tp?new tp(l*f):new Uint8Array(l*f);let d=0;for(let t=0;t<a;t++)o.set(F[t],d),d+=F[t].byteLength;return o},i.fftJoin=async function(t,n,h,o){let f,l,u;let a=3*i.F.n8;if("G1"==e)f="g1m_fftJoin";else if("G2"==e)f="g2m_fftJoin";else if("Fr"==e)f="frm_fftJoin";else throw Error("Invalid group");if(t.byteLength!=n.byteLength)throw Error("Invalid buffer size");let p=Math.floor(t.byteLength/a);if(p!=1<<to(p))throw Error("Invalid number of points");let m=1<<to(s.concurrency);p<=2*m&&(m=1);let c=p/m,g=[];for(let e=0;e<m;e++){let i=[],l=r.mul(h,r.exp(o,e*c)),u=t.slice(e*c*a,(e+1)*c*a),p=n.slice(e*c*a,(e+1)*c*a);i.push({cmd:"ALLOCSET",var:0,buff:u}),i.push({cmd:"ALLOCSET",var:1,buff:p}),i.push({cmd:"ALLOCSET",var:2,buff:l}),i.push({cmd:"ALLOCSET",var:3,buff:o}),i.push({cmd:"CALL",fnName:f,params:[{var:0},{var:1},{val:c},{var:2},{var:3}]}),i.push({cmd:"GET",out:0,var:0,len:c*a}),i.push({cmd:"GET",out:1,var:1,len:c*a}),g.push(s.queueAction(i))}let F=await Promise.all(g);t instanceof tp?(l=new tp(p*a),u=new tp(p*a)):(l=new Uint8Array(p*a),u=new Uint8Array(p*a));let d=0;for(let t=0;t<F.length;t++)l.set(F[t][0],d),u.set(F[t][1],d),d+=F[t][0].byteLength;return[l,u]},i.fftFinal=async function(t,r){let n,h,o;let f=3*i.F.n8,l=2*i.F.n8;if("G1"==e)n="g1m_fftFinal",h="g1m_batchToAffine";else if("G2"==e)n="g2m_fftFinal",h="g2m_batchToAffine";else throw Error("Invalid group");let u=Math.floor(t.byteLength/f);if(u!=1<<to(u))throw Error("Invalid number of points");let a=Math.floor(u/s.concurrency),p=[];for(let e=0;e<s.concurrency;e++){let i;if(0==(i=e<s.concurrency-1?a:u-e*a))continue;let o=[],m=t.slice(e*a*f,(e*a+i)*f);o.push({cmd:"ALLOCSET",var:0,buff:m}),o.push({cmd:"ALLOCSET",var:1,buff:r}),o.push({cmd:"CALL",fnName:n,params:[{var:0},{val:i},{var:1}]}),o.push({cmd:"CALL",fnName:h,params:[{var:0},{val:i},{var:0}]}),o.push({cmd:"GET",out:0,var:0,len:i*l}),p.push(s.queueAction(o))}let m=await Promise.all(p);o=t instanceof tp?new tp(u*l):new Uint8Array(u*l);let c=0;for(let t=m.length-1;t>=0;t--)o.set(m[t][0],c),c+=m[t][0].byteLength;return o}}async function t_(t){let e=await tw(t.wasm,t.singleThread),i={};return i.q=a(t.wasm.q.toString()),i.r=a(t.wasm.r.toString()),i.name=t.name,i.tm=e,i.prePSize=t.wasm.prePSize,i.preQSize=t.wasm.preQSize,i.Fr=new tc(e,"frm",t.n8r,t.r),i.F1=new tc(e,"f1m",t.n8q,t.q),i.F2=new tg(e,"f2m",i.F1),i.G1=new td(e,"g1m",i.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),i.G2=new td(e,"g2m",i.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),i.F6=new tF(e,"f6m",i.F2),i.F12=new tg(e,"ftm",i.F6),i.Gt=i.F12,tO(i,"G1"),tO(i,"G2"),tO(i,"Fr"),tq(i,"G1"),tq(i,"G2"),tA(i,"G1"),tA(i,"G2"),tA(i,"Fr"),!function(t){let e=t.tm;t.pairing=function(i,r){e.startSyncOp();let s=e.allocBuff(t.G1.toJacobian(i)),n=e.allocBuff(t.G2.toJacobian(r)),h=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](s,n,h);let o=e.getBuff(h,t.Gt.n8);return e.endSyncOp(),o},t.pairingEq=async function(){let i,r;arguments.length%2==1?(i=arguments[arguments.length-1],r=(arguments.length-1)/2):(i=t.Gt.one,r=arguments.length/2);let s=[];for(let i=0;i<r;i++){let r=[],n=t.G1.toJacobian(arguments[2*i]);r.push({cmd:"ALLOCSET",var:0,buff:n}),r.push({cmd:"ALLOC",var:1,len:t.prePSize});let h=t.G2.toJacobian(arguments[2*i+1]);r.push({cmd:"ALLOCSET",var:2,buff:h}),r.push({cmd:"ALLOC",var:3,len:t.preQSize}),r.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),r.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),r.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),r.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),r.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),s.push(e.queueAction(r))}let n=await Promise.all(s);e.startSyncOp();let h=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(h);for(let t=0;t<n.length;t++){let i=e.allocBuff(n[t][0]);e.instance.exports.ftm_mul(h,i,h)}e.instance.exports[t.name+"_finalExponentiation"](h,h);let o=e.allocBuff(i),f=!!e.instance.exports.ftm_eq(h,o);return e.endSyncOp(),f},t.prepareG1=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),i=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,i);let r=this.tm.getBuff(i,this.prePSize);return this.tm.endSyncOp(),r},t.prepareG2=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),i=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,i);let r=this.tm.getBuff(i,this.preQSize);return this.tm.endSyncOp(),r},t.millerLoop=function(t,e){this.tm.startSyncOp();let i=this.tm.allocBuff(t),r=this.tm.allocBuff(e),s=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](i,r,s);let n=this.tm.getBuff(s,this.Gt.n8);return this.tm.endSyncOp(),n},t.finalExponentiation=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),i=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,i);let r=this.tm.getBuff(i,this.Gt.n8);return this.tm.endSyncOp(),r}}(i),i.array2buffer=function(t,e){let i=new Uint8Array(e*t.length);for(let r=0;r<t.length;r++)i.set(t[r],r*e);return i},i.buffer2array=function(t,e){let i=t.byteLength/e,r=Array(i);for(let s=0;s<i;s++)r[s]=t.slice(s*e,s*e+e);return r},i}async function tx(t,e){let i=new h.ModuleBuilder;i.setMemory(25),r.buildBn128(i),e&&e(i);let s={};if(s.code=i.build(),s.pq=i.modules.f1m.pq,s.pr=i.modules.frm.pq,s.pG1gen=i.modules.bn128.pG1gen,s.pG1zero=i.modules.bn128.pG1zero,s.pG1b=i.modules.bn128.pG1b,s.pG2gen=i.modules.bn128.pG2gen,s.pG2zero=i.modules.bn128.pG2zero,s.pG2b=i.modules.bn128.pG2b,s.pOneT=i.modules.bn128.pOneT,s.prePSize=i.modules.bn128.prePSize,s.preQSize=i.modules.bn128.preQSize,s.n8q=32,s.n8r=32,s.q=i.modules.bn128.q,s.r=i.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;let n={name:"bn128",wasm:s,q:a("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:a("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:a("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},o=await t_(n);return o.terminate=async function(){n.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=o),o}async function tR(t,e){let i=new h.ModuleBuilder;i.setMemory(25),r.buildBls12381(i),e&&e(i);let s={};if(s.code=i.build(),s.pq=i.modules.f1m.pq,s.pr=i.modules.frm.pq,s.pG1gen=i.modules.bls12381.pG1gen,s.pG1zero=i.modules.bls12381.pG1zero,s.pG1b=i.modules.bls12381.pG1b,s.pG2gen=i.modules.bls12381.pG2gen,s.pG2zero=i.modules.bls12381.pG2zero,s.pG2b=i.modules.bls12381.pG2b,s.pOneT=i.modules.bls12381.pOneT,s.prePSize=i.modules.bls12381.prePSize,s.preQSize=i.modules.bls12381.preQSize,s.n8q=48,s.n8r=32,s.q=i.modules.bls12381.q,s.r=i.modules.bls12381.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let n={name:"bls12381",wasm:s,q:a("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:a("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:a("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:a("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},o=await t_(n);return o.terminate=async function(){n.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=o),o}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;let tM=a("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),tI=a("21888242871839275222246405745257275088548364400416034343698204186575808495617"),tz=a("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),tS=a("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function tG(t,e,i){let r;if(A(t,tI))r=await tx(e,i);else if(A(t,tM))r=await tR(e,i);else throw Error(`Curve not supported: ${G(t)}`);return r}async function tT(t,e,i){let r;if(A(t,tS))r=await tx(e,i);else if(A(t,tz))r=await tR(e,i);else throw Error(`Curve not supported: ${G(t,16)}`);return r}async function tU(t,e,i){let r;let s=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(s)>=0)r=await tx(e,i);else if(["BLS12381"].indexOf(s)>=0)r=await tR(e,i);else throw Error(`Curve not supported: ${t}`);return r}e.BigBuffer=tp,e.ChaCha=V,e.EC=class{constructor(t,e){this.F=t,this.g=e,2==this.g.length&&(this.g[2]=this.F.one),this.zero=[this.F.zero,this.F.one,this.F.zero]}add(t,e){let i=this.F;if(this.eq(t,this.zero))return e;if(this.eq(e,this.zero))return t;let r=[,,,],s=i.square(t[2]),n=i.square(e[2]),h=i.mul(t[0],n),o=i.mul(e[0],s),f=i.mul(t[2],s),l=i.mul(e[2],n),u=i.mul(t[1],l),a=i.mul(e[1],f);if(i.eq(h,o)&&i.eq(u,a))return this.double(t);let p=i.sub(o,h),m=i.sub(a,u),c=i.square(i.add(p,p)),g=i.mul(p,c),F=i.add(m,m),d=i.mul(h,c);r[0]=i.sub(i.sub(i.square(F),g),i.add(d,d));let b=i.mul(u,g);return r[1]=i.sub(i.mul(F,i.sub(d,r[0])),i.add(b,b)),r[2]=i.mul(p,i.sub(i.square(i.add(t[2],e[2])),i.add(s,n))),r}neg(t){return[t[0],this.F.neg(t[1]),t[2]]}sub(t,e){return this.add(t,this.neg(e))}double(t){let e=this.F,i=[,,,];if(this.eq(t,this.zero))return t;let r=e.square(t[0]),s=e.square(t[1]),n=e.square(s),h=e.sub(e.square(e.add(t[0],s)),e.add(r,n));h=e.add(h,h);let o=e.add(e.add(r,r),r),f=e.square(o);i[0]=e.sub(f,e.add(h,h));let l=e.add(n,n);l=e.add(l,l),l=e.add(l,l),i[1]=e.sub(e.mul(o,e.sub(h,i[0])),l);let u=e.mul(t[1],t[2]);return i[2]=e.add(u,u),i}timesScalar(t,e){return J(this,t,e)}mulScalar(t,e){return J(this,t,e)}affine(t){let e=this.F;if(this.isZero(t))return this.zero;if(e.eq(t[2],e.one))return t;{let i=e.inv(t[2]),r=e.square(i),s=e.mul(r,i),n=[,,,];return n[0]=e.mul(t[0],r),n[1]=e.mul(t[1],s),n[2]=e.one,n}}multiAffine(t){let e=Object.keys(t),i=this.F,r=Array(e.length+1);r[0]=i.one;for(let s=0;s<e.length;s++)i.eq(t[e[s]][2],i.zero)?r[s+1]=r[s]:r[s+1]=i.mul(r[s],t[e[s]][2]);r[e.length]=i.inv(r[e.length]);for(let s=e.length-1;s>=0;s--)if(i.eq(t[e[s]][2],i.zero))r[s]=r[s+1],t[e[s]]=this.zero;else{let n=i.mul(r[s],r[s+1]);r[s]=i.mul(t[e[s]][2],r[s+1]);let h=i.square(n),o=i.mul(h,n);t[e[s]][0]=i.mul(t[e[s]][0],h),t[e[s]][1]=i.mul(t[e[s]][1],o),t[e[s]][2]=i.one}}eq(t,e){let i=this.F;if(this.F.eq(t[2],this.F.zero))return this.F.eq(e[2],this.F.zero);if(this.F.eq(e[2],this.F.zero))return!1;let r=i.square(t[2]),s=i.square(e[2]),n=i.mul(t[0],s),h=i.mul(e[0],r),o=i.mul(t[2],r),f=i.mul(e[2],s),l=i.mul(t[1],f),u=i.mul(e[1],o);return i.eq(n,h)&&i.eq(l,u)}isZero(t){return this.F.isZero(t[2])}toString(t){let e=this.affine(t);return`[ ${this.F.toString(e[0])} , ${this.F.toString(e[1])} ]`}fromRng(t){let e;let i=this.F,r=[];do{r[0]=i.fromRng(t),e=t.nextBool();let s=i.add(i.mul(i.square(r[0]),r[0]),this.b);r[1]=i.sqrt(s)}while(null==r[1]||i.isZero[r]);let s=tr(i,r[1]);return e^s&&(r[1]=i.neg(r[1])),r[2]=i.one,this.cofactor&&(r=this.mulScalar(r,this.cofactor)),r=this.affine(r)}toRprLE(t,e,i){if(i=this.affine(i),this.isZero(i)){let i=new Uint8Array(t,e,2*this.F.n8);i.fill(0);return}this.F.toRprLE(t,e,i[0]),this.F.toRprLE(t,e+this.F.n8,i[1])}toRprBE(t,e,i){if(i=this.affine(i),this.isZero(i)){let i=new Uint8Array(t,e,2*this.F.n8);i.fill(0);return}this.F.toRprBE(t,e,i[0]),this.F.toRprBE(t,e+this.F.n8,i[1])}toRprLEM(t,e,i){if(i=this.affine(i),this.isZero(i)){let i=new Uint8Array(t,e,2*this.F.n8);i.fill(0);return}this.F.toRprLEM(t,e,i[0]),this.F.toRprLEM(t,e+this.F.n8,i[1])}toRprLEJM(t,e,i){if(i=this.affine(i),this.isZero(i)){let i=new Uint8Array(t,e,2*this.F.n8);i.fill(0);return}this.F.toRprLEM(t,e,i[0]),this.F.toRprLEM(t,e+this.F.n8,i[1]),this.F.toRprLEM(t,e+2*this.F.n8,i[2])}toRprBEM(t,e,i){if(i=this.affine(i),this.isZero(i)){let i=new Uint8Array(t,e,2*this.F.n8);i.fill(0);return}this.F.toRprBEM(t,e,i[0]),this.F.toRprBEM(t,e+this.F.n8,i[1])}fromRprLE(t,e){e=e||0;let i=this.F.fromRprLE(t,e),r=this.F.fromRprLE(t,e+this.F.n8);return this.F.isZero(i)&&this.F.isZero(r)?this.zero:[i,r,this.F.one]}fromRprBE(t,e){e=e||0;let i=this.F.fromRprBE(t,e),r=this.F.fromRprBE(t,e+this.F.n8);return this.F.isZero(i)&&this.F.isZero(r)?this.zero:[i,r,this.F.one]}fromRprLEM(t,e){e=e||0;let i=this.F.fromRprLEM(t,e),r=this.F.fromRprLEM(t,e+this.F.n8);return this.F.isZero(i)&&this.F.isZero(r)?this.zero:[i,r,this.F.one]}fromRprLEJM(t,e){e=e||0;let i=this.F.fromRprLEM(t,e),r=this.F.fromRprLEM(t,e+this.F.n8),s=this.F.fromRprLEM(t,e+2*this.F.n8);return this.F.isZero(i)&&this.F.isZero(r)?this.zero:[i,r,s]}fromRprBEM(t,e){e=e||0;let i=this.F.fromRprBEM(t,e),r=this.F.fromRprBEM(t,e+this.F.n8);return this.F.isZero(i)&&this.F.isZero(r)?this.zero:[i,r,this.F.one]}fromRprCompressed(t,e){let i=this.F,r=new Uint8Array(t.buffer,e,i.n8);if(64&r[0])return this.zero;let s=[,,,],n=(128&r[0])!=0;r[0]=127&r[0],s[0]=i.fromRprBE(t,e),n&&(r[0]=128|r[0]);let h=i.add(i.mul(i.square(s[0]),s[0]),this.b);if(s[1]=i.sqrt(h),null===s[1])throw Error("Invalid Point!");let o=tr(i,s[1]);return n^o&&(s[1]=i.neg(s[1])),s[2]=i.one,s}toRprCompressed(t,e,i){i=this.affine(i);let r=new Uint8Array(t.buffer,e,this.F.n8);if(this.isZero(i)){r.fill(0),r[0]=64;return}this.F.toRprBE(t,e,i[0]),tr(this.F,i[1])&&(r[0]=128|r[0])}fromRprUncompressed(t,e){return 64&t[0]?this.zero:this.fromRprBE(t,e)}toRprUncompressed(t,e,i){this.toRprBE(t,e,i),this.isZero(i)&&(t[e]=64|t[e])}},e.F1Field=ti,e.F2Field=class{constructor(t,e){this.type="F2",this.F=t,this.zero=[this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=e,this.m=2*t.m,this.p=t.p,this.n64=2*t.n64,this.n32=2*this.n64,this.n8=8*this.n64,X(this)}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1])]}add(t,e){return[this.F.add(t[0],e[0]),this.F.add(t[1],e[1])]}double(t){return this.add(t,t)}sub(t,e){return[this.F.sub(t[0],e[0]),this.F.sub(t[1],e[1])]}neg(t){return this.sub(this.zero,t)}conjugate(t){return[t[0],this.F.neg(t[1])]}mul(t,e){let i=this.F.mul(t[0],e[0]),r=this.F.mul(t[1],e[1]);return[this.F.add(i,this._mulByNonResidue(r)),this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(e[0],e[1])),this.F.add(i,r))]}inv(t){let e=this.F.square(t[0]),i=this.F.square(t[1]),r=this.F.sub(e,this._mulByNonResidue(i)),s=this.F.inv(r);return[this.F.mul(t[0],s),this.F.neg(this.F.mul(t[1],s))]}div(t,e){return this.mul(t,this.inv(e))}square(t){let e=this.F.mul(t[0],t[1]);return[this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(t[0],this._mulByNonResidue(t[1]))),this.F.add(e,this._mulByNonResidue(e))),this.F.add(e,e)]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])}eq(t,e){return this.F.eq(t[0],e[0])&&this.F.eq(t[1],e[1])}mulScalar(t,e){return J(this,t,e)}pow(t,e){return Q(this,t,e)}exp(t,e){return Q(this,t,e)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])} ]`}fromRng(t){let e=this.F.fromRng(t),i=this.F.fromRng(t);return[e,i]}gt(t,e){return!!this.F.gt(t[0],e[0])||!this.F.gt(e[0],t[0])&&!!this.F.gt(t[1],e[1])}geq(t,e){return this.gt(t,e)||this.eq(t,e)}lt(t,e){return!this.geq(t,e)}leq(t,e){return!this.gt(t,e)}neq(t,e){return!this.eq(t,e)}random(){return[this.F.random(),this.F.random()]}toRprLE(t,e,i){this.F.toRprLE(t,e,i[0]),this.F.toRprLE(t,e+this.F.n8,i[1])}toRprBE(t,e,i){this.F.toRprBE(t,e,i[1]),this.F.toRprBE(t,e+this.F.n8,i[0])}toRprLEM(t,e,i){this.F.toRprLEM(t,e,i[0]),this.F.toRprLEM(t,e+this.F.n8,i[1])}toRprBEM(t,e,i){this.F.toRprBEM(t,e,i[1]),this.F.toRprBEM(t,e+this.F.n8,i[0])}fromRprLE(t,e){e=e||0;let i=this.F.fromRprLE(t,e),r=this.F.fromRprLE(t,e+this.F.n8);return[i,r]}fromRprBE(t,e){e=e||0;let i=this.F.fromRprBE(t,e),r=this.F.fromRprBE(t,e+this.F.n8);return[r,i]}fromRprLEM(t,e){e=e||0;let i=this.F.fromRprLEM(t,e),r=this.F.fromRprLEM(t,e+this.F.n8);return[i,r]}fromRprBEM(t,e){e=e||0;let i=this.F.fromRprBEM(t,e),r=this.F.fromRprBEM(t,e+this.F.n8);return[r,i]}toObject(t){return t}},e.F3Field=class{constructor(t,e){this.type="F3",this.F=t,this.zero=[this.F.zero,this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=e,this.m=3*t.m,this.p=t.p,this.n64=3*t.n64,this.n32=2*this.n64,this.n8=8*this.n64}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1]),this.F.copy(t[2])]}add(t,e){return[this.F.add(t[0],e[0]),this.F.add(t[1],e[1]),this.F.add(t[2],e[2])]}double(t){return this.add(t,t)}sub(t,e){return[this.F.sub(t[0],e[0]),this.F.sub(t[1],e[1]),this.F.sub(t[2],e[2])]}neg(t){return this.sub(this.zero,t)}mul(t,e){let i=this.F.mul(t[0],e[0]),r=this.F.mul(t[1],e[1]),s=this.F.mul(t[2],e[2]);return[this.F.add(i,this._mulByNonResidue(this.F.sub(this.F.mul(this.F.add(t[1],t[2]),this.F.add(e[1],e[2])),this.F.add(r,s)))),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(e[0],e[1])),this.F.add(i,r)),this._mulByNonResidue(s)),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[2]),this.F.add(e[0],e[2])),this.F.add(i,s)),r)]}inv(t){let e=this.F.square(t[0]),i=this.F.square(t[1]),r=this.F.square(t[2]),s=this.F.mul(t[0],t[1]),n=this.F.mul(t[0],t[2]),h=this.F.mul(t[1],t[2]),o=this.F.sub(e,this._mulByNonResidue(h)),f=this.F.sub(this._mulByNonResidue(r),s),l=this.F.sub(i,n),u=this.F.inv(this.F.add(this.F.mul(t[0],o),this._mulByNonResidue(this.F.add(this.F.mul(t[2],f),this.F.mul(t[1],l)))));return[this.F.mul(u,o),this.F.mul(u,f),this.F.mul(u,l)]}div(t,e){return this.mul(t,this.inv(e))}square(t){let e=this.F.square(t[0]),i=this.F.mul(t[0],t[1]),r=this.F.add(i,i),s=this.F.square(this.F.add(this.F.sub(t[0],t[1]),t[2])),n=this.F.mul(t[1],t[2]),h=this.F.add(n,n),o=this.F.square(t[2]);return[this.F.add(e,this._mulByNonResidue(h)),this.F.add(r,this._mulByNonResidue(o)),this.F.sub(this.F.add(this.F.add(r,s),h),this.F.add(e,o))]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])&&this.F.isZero(t[2])}eq(t,e){return this.F.eq(t[0],e[0])&&this.F.eq(t[1],e[1])&&this.F.eq(t[2],e[2])}affine(t){return[this.F.affine(t[0]),this.F.affine(t[1]),this.F.affine(t[2])]}mulScalar(t,e){return J(this,t,e)}pow(t,e){return Q(this,t,e)}exp(t,e){return Q(this,t,e)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])}, ${this.F.toString(t[2])} ]`}fromRng(t){let e=this.F.fromRng(t),i=this.F.fromRng(t),r=this.F.fromRng(t);return[e,i,r]}gt(t,e){return!!this.F.gt(t[0],e[0])||!this.F.gt(e[0],t[0])&&(!!this.F.gt(t[1],e[1])||!this.F.gt(e[1],t[1])&&!!this.F.gt(t[2],e[2]))}geq(t,e){return this.gt(t,e)||this.eq(t,e)}lt(t,e){return!this.geq(t,e)}leq(t,e){return!this.gt(t,e)}neq(t,e){return!this.eq(t,e)}random(){return[this.F.random(),this.F.random(),this.F.random()]}toRprLE(t,e,i){this.F.toRprLE(t,e,i[0]),this.F.toRprLE(t,e+this.F.n8,i[1]),this.F.toRprLE(t,e+2*this.F.n8,i[2])}toRprBE(t,e,i){this.F.toRprBE(t,e,i[2]),this.F.toRprBE(t,e+this.F.n8,i[1]),this.F.toRprBE(t,e+2*this.F.n8,i[0])}toRprLEM(t,e,i){this.F.toRprLEM(t,e,i[0]),this.F.toRprLEM(t,e+this.F.n8,i[1]),this.F.toRprLEM(t,e+2*this.F.n8,i[2])}toRprBEM(t,e,i){this.F.toRprBEM(t,e,i[2]),this.F.toRprBEM(t,e+this.F.n8,i[1]),this.F.toRprBEM(t,e+2*this.F.n8,i[0])}fromRprLE(t,e){e=e||0;let i=this.F.fromRprLE(t,e),r=this.F.fromRprLE(t,e+this.n8),s=this.F.fromRprLE(t,e+2*this.n8);return[i,r,s]}fromRprBE(t,e){e=e||0;let i=this.F.fromRprBE(t,e),r=this.F.fromRprBE(t,e+this.n8),s=this.F.fromRprBE(t,e+2*this.n8);return[s,r,i]}fromRprLEM(t,e){e=e||0;let i=this.F.fromRprLEM(t,e),r=this.F.fromRprLEM(t,e+this.n8),s=this.F.fromRprLEM(t,e+2*this.n8);return[i,r,s]}fromRprBEM(t,e){e=e||0;let i=this.F.fromRprBEM(t,e),r=this.F.fromRprBEM(t,e+this.n8),s=this.F.fromRprBEM(t,e+2*this.n8);return[s,r,i]}toObject(t){return t}},e.PolField=class t{constructor(t){this.F=t;let e=t.sqrt_t,i=t.sqrt_s,r=this.F.add(this.F.add(this.F.two,this.F.two),this.F.one);this.w=Array(i+1),this.wi=Array(i+1),this.w[i]=this.F.pow(r,e),this.wi[i]=this.F.inv(this.w[i]);let s=i-1;for(;s>=0;)this.w[s]=this.F.square(this.w[s+1]),this.wi[s]=this.F.square(this.wi[s+1]),s--;this.roots=[],this._setRoots(15)}_setRoots(t){t>this.F.sqrt_s&&(t=this.s);for(let e=t;e>=0&&!this.roots[e];e--){let t=this.F.one,i=1<<e,r=Array(i);for(let s=0;s<i;s++)r[s]=t,t=this.F.mul(t,this.w[e]);this.roots[e]=r}}add(t,e){let i=Math.max(t.length,e.length),r=Array(i);for(let s=0;s<i;s++)r[s]=this.F.add(t[s]||this.F.zero,e[s]||this.F.zero);return this.reduce(r)}double(t){return this.add(t,t)}sub(t,e){let i=Math.max(t.length,e.length),r=Array(i);for(let s=0;s<i;s++)r[s]=this.F.sub(t[s]||this.F.zero,e[s]||this.F.zero);return this.reduce(r)}mulScalar(t,e){if(this.F.eq(e,this.F.zero))return[];if(this.F.eq(e,this.F.one))return t;let i=Array(t.length);for(let r=0;r<t.length;r++)i[r]=this.F.mul(t[r],e);return i}mul(t,e){return 0==t.length||0==e.length?[]:1==t.length?this.mulScalar(e,t[0]):1==e.length?this.mulScalar(t,e[0]):(e.length>t.length&&([e,t]=[t,e]),e.length<=2||e.length<j(t.length))?this.mulNormal(t,e):this.mulFFT(t,e)}mulNormal(t,e){let i=[];for(let r=0;r<e.length;r++)i=this.add(i,this.scaleX(this.mulScalar(t,e[r]),r));return i}mulFFT(t,e){let i=Math.max(t.length,e.length),r=j(i-1)+2;this._setRoots(r);let s=1<<r,n=this.extend(t,s),h=this.extend(e,s),o=$(this,n,r,0,1),f=$(this,h,r,0,1),l=Array(s);for(let t=0;t<s;t++)l[t]=this.F.mul(o[t],f[t]);let u=$(this,l,r,0,1),a=this.F.inv(this.F.mulScalar(this.F.one,s)),p=Array(s);for(let t=0;t<s;t++)p[t]=this.F.mul(u[(s-t)%s],a);return this.reduce(p)}square(t){return this.mul(t,t)}scaleX(t,e){if(0==e)return t;if(e>0){let i=Array(e).fill(this.F.zero);return i.concat(t)}return-e>=t.length?[]:t.slice(-e)}eval2(t,e){let i=this.F.zero,r=this.F.one;for(let s=0;s<t.length;s++)i=this.F.add(i,this.F.mul(t[s],r)),r=this.F.mul(r,e);return i}eval(t,e){let i=this.F;if(0==t.length)return i.zero;let r=this._next2Power(t.length),s=this.extend(t,r);return function t(e,r,s,n,h){if(1==h)return e[s];let o=i.square(r),f=i.add(t(e,o,s,n<<1,h>>1),i.mul(r,t(e,o,s+n,n<<1,h>>1)));return f}(s,e,0,1,r)}lagrange(t){let e=[this.F.one];for(let i=0;i<t.length;i++)e=this.mul(e,[this.F.neg(t[i][0]),this.F.one]);let i=[];for(let r=0;r<t.length;r++){let s=this.ruffini(e,t[r][0]),n=this.F.mul(this.F.inv(this.eval(s,t[r][0])),t[r][1]);s=this.mulScalar(s,n),i=this.add(i,s)}return i}fft(t){if(t.length<=1)return t;let e=j(t.length-1)+1;this._setRoots(e);let i=this.extend(t,1<<e),r=$(this,i,e,0,1);return r}fft2(t){if(t.length<=1)return t;let e=j(t.length-1)+1;this._setRoots(e);let i=this.extend(t,1<<e);P(i,e);let r=k(this,i,e);return r}ifft(t){if(t.length<=1)return t;let e=j(t.length-1)+1;this._setRoots(e);let i=1<<e,r=this.extend(t,i),s=$(this,r,e,0,1),n=this.F.inv(this.F.mulScalar(this.F.one,i)),h=Array(i);for(let t=0;t<i;t++)h[t]=this.F.mul(s[(i-t)%i],n);return h}ifft2(t){if(t.length<=1)return t;let e=j(t.length-1)+1;this._setRoots(e);let i=1<<e,r=this.extend(t,i);P(r,e);let s=k(this,r,e),n=this.F.inv(this.F.mulScalar(this.F.one,i)),h=Array(i);for(let t=0;t<i;t++)h[t]=this.F.mul(s[(i-t)%i],n);return h}_fft(t,e,i,r){let s=1<<e;if(1==s)return[t[i]];let n=s>>1,h=this._fft(t,e-1,i,2*r),o=this._fft(t,e-1,i+r,2*r),f=Array(s),l=this.F.one;for(let t=0;t<n;t++)f[t]=this.F.add(h[t],this.F.mul(l,o[t])),f[t+n]=this.F.sub(h[t],this.F.mul(l,o[t])),l=this.F.mul(l,this.w[e]);return f}extend(t,e){if(e==t.length)return t;let i=Array(e-t.length).fill(this.F.zero);return t.concat(i)}reduce(t){if(0==t.length||!this.F.eq(t[t.length-1],this.F.zero))return t;let e=t.length-1;for(;e>0&&this.F.eq(t[e],this.F.zero);)e--;return t.slice(0,e+1)}eq(t,e){let i=this.reduce(t),r=this.reduce(e);if(i.length!=r.length)return!1;for(let t=0;t<r.length;t++)if(!this.F.eq(i[t],r[t]))return!1;return!0}ruffini(t,e){let i=Array(t.length-1);i[i.length-1]=t[t.length-1];for(let r=i.length-2;r>=0;r--)i[r]=this.F.add(this.F.mul(i[r+1],e),t[r+1]);return i}_next2Power(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}toString(t){let e=this.normalize(t),i="";for(let r=e.length-1;r>=0;r--)!this.F.eq(t[r],this.F.zero)&&(""!=i&&(i+=" + "),i+=t[r].toString(10),r>0&&(i+="x",r>1&&(i=i+"^"+r)));return i}normalize(t){let e=Array(t.length);for(let i=0;i<t.length;i++)e[i]=this.F.normalize(t[i]);return e}_reciprocal(t,e){let i=1<<e;if(1==i)return[this.F.inv(t[0])];let r=this.scaleX(t,-i/2),s=this._reciprocal(r,e-1),n=this.scaleX(this.double(s),3*i/2-2),h=this.mul(this.square(s),t);return this.scaleX(this.sub(n,h),-(i-2))}_div2(t,e){let i=j(e.length-1)+1,r=1<<i,s=r-e.length,n=this._reciprocal(this.scaleX(e,s),i),h=this.scaleX(n,t-2*r+2+s);return h}div(t,e){let i,r,s;if(t.length<e.length)return[];let n=j(e.length-1)+1,h=1<<n,o=this.scaleX(t,h-e.length),f=this.scaleX(e,h-e.length),l=f.length-1,u=o.length-1,a=this._reciprocal(f,n);u>2*l&&(i=this.sub(this.scaleX([this.F.one],2*l),this.mul(a,f)));let p=[],m=o,c=!1;for(;!c;)r=this.mul(m,a),p=this.add(p,this.scaleX(r,-2*l)),u>2*l?(s=this.mul(m,i),u=(m=this.scaleX(s,-2*l)).length-1):c=!0;return p}oneRoot(t,e){let i=j(t-1)+1,r=this.F.one,s=e;if(e>=t)throw Error("Given 'i' should be lower than 'n'");if(1<<i!==t)throw Error(`Internal errlr: ${t} should equal ${1<<i}`);for(;s>0;)!0&s&&(r=this.F.mul(r,this.w[i])),s>>=1,i--;return r}computeVanishingPolinomial(t,e){return this.F.sub(this.F.pow(e,1<<t),this.F.one)}evaluateLagrangePolynomials(t,e){let i=1<<t,r=this.F.pow(e,i),s=Array(i).fill(this.F.zero);this._setRoots(t);let n=this.w[t];if(this.F.eq(r,this.F.one)){for(let r=0;r<i;r++)if(this.F.eq(this.roots[t][0],e))return s[r]=this.F.one,s}let h=this.F.sub(r,this.F.one),o=this.F.mul(h,this.F.inv(this.F.e(i)));for(let r=0;r<i;r++)s[r]=this.F.mul(o,this.F.inv(this.F.sub(e,this.roots[t][r]))),o=this.F.mul(o,n);return s}log2(t){return j(t)}},e.Scalar=N,e.ZqField=ti,e.buildBls12381=tR,e.buildBn128=tx,e.getCurveFromName=tU,e.getCurveFromQ=tT,e.getCurveFromR=tG,e.utils=ta}}]);